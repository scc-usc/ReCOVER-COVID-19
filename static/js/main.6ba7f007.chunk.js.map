{"version":3,"sources":["covid19graph.js","modelapi.js","covid19util.js","covid19map.js","covid19predict.js","aboutus.js","scorePage/scoreMap.js","scorePage/scorePage.js","navbar/navbar.js","covid19app.js","serviceWorker.js","index.js"],"names":["DashedLine","series","lineGenerator","xScale","yScale","map","id","data","color","predicted","distancing","style","strokeWidth","strokeDasharray","key","d","x","y","fill","stroke","theme","axis","ticks","text","fontSize","legend","legends","Covid19Graph","dateStr","split","Number","year","month","day","Date","parseDate","date","value","initialVal","i","params","statistic","retData","this","getDeltaData","getCumulativeData","filter","props","max","Object","keys","forEach","area","observed","predictions","Math","p","timeSeries","time_series","linearAxisLeft","format","numeral","orient","tickSize","tickPadding","tickRotation","legendOffset","legendPosition","logTickValues","ceil","log10","getDataMax","push","pow","logAxisLeft","tickValues","axisLeft","gridYValues","type","base","min","chartData","colors","sort","idx","lineColor","index","red","primary","gold","lime","cyan","geekblue","purple","magenta","length","getLineColor","observedData","processData","model","name","minDate","maxDate","moment","diff","margin","top","right","bottom","left","precision","axisBottom","getYAxisProps","enableSlices","sliceTooltip","slice","background","padding","border","points","point","serieColor","serieId","yFormatted","pointSize","pointLabel","pointLabelYOffset","anchor","direction","justify","translateX","translateY","itemsSpacing","itemDirection","itemWidth","itemHeight","itemOpacity","symbolSize","symbolShape","symbolBorderColor","effects","on","itemBackground","layers","Component","API_BASE_URL","process","ModelAPI","callback","endpoint","axios","get","then","res","allAreas","allModels","currentDate","latestDate","areaToStr","a","country","state","strToArea","s","words","trim","am4core","am4themes_animated","Covid19Map","onShowState","setState","showState","modelAPI","areasList","areas","triggerRef","fetchData","dynamicMapOn","days","predict_all","cumulativeInfections","console","log","heatmapData","iso_2","valueTrue","resetChart","history_cumulative","historyCumulative","previousCumulative","find","historyInfections","nextDayCumulative","cumulative_infections","createChart","chart","am4maps","projection","Mercator","seriesProps","polygonTemplate","assign","mapPolygons","template","heatRules","property","target","minValue","maxValue","tooltipText","nonScalingStroke","states","create","properties","cursorOverStyle","pointer","onMapClick","onNoData","events","e","dataItem","dataContext","zoomControl","button","chartContainer","createChild","label","togglable","align","marginRight","isActive","stateSeries","disabled","initChart","createChartSeries","geodata","am4geodata_worldLow","exclude","chinaSeries","am4geodata_chinaLow","usaSeries","am4geodata_usaLow","canadaSeries","am4geodata_canadaLow","australiaSeries","am4geodata_australiaLow","initChartInterface","dispose","Option","Covid19Predict","handleYScaleSelect","handleStatisticSelect","reloadAll","componentWillMount","addAreaByStr","formRef","React","createRef","models","modelsList","getCurrentDate","bindRef","ref","onAlertClose","noDataError","errorDescription","generateMarks","firstDate","setDate","getDate","marks","getMonth","getDaysToFirstDate","abs","distancingOn","distancingOff","mainGraphData","bind","removeAreaByStr","onValuesChange","onDaysToPredictChange","switchDynamicMap","areaIsSelected","newAreaStr","includes","areaStr","areaObj","prevState","predict","checkHistory","current","setFieldsValue","targetAreaStr","reduce","newMainGraphData","newModelStr","changedValues","allValues","socialDistancing","prevAreas","newAreas","areasToAdd","areasToRemove","checked","daysToFirstDate","countryOptions","modelOptions","modelIsSelected","title","description","placement","SOCIAL_DISTANCING_CLARIFICATION","href","className","span","message","closable","onClose","initialValues","Item","rules","required","mode","width","placeholder","initialValue","onAfterChange","content","Group","defaultChecked","onChange","PureComponent","AboutUs","ScoreMap","scores_all","weeks","scores","latestWeek","conf","ScorePage","componentDidMount","latest_score_date","lastDate","onWeeksChange","NavBar","handleItemClick","redirectForecast","redirectAbout","redirectScore","activeItem","activateItem","src","alt","onClick","defaultSelectedKeys","Covid19App","to","exact","path","render","Boolean","window","location","hostname","match","ReactDOM","document","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","error"],"mappings":"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","file":"static/js/main.6ba7f007.chunk.js","sourcesContent":["import React, { Component } from \"react\";\nimport { ResponsiveLine } from \"@nivo/line\";\nimport moment from \"moment\";\nimport numeral from \"numeral\";\nimport {\n  red,\n  gold,\n  lime,\n  cyan,\n  geekblue,\n  purple,\n  magenta\n} from \"@ant-design/colors\";\n\nfunction getLineColor(index) {\n  const colors = [\n    red.primary,\n    gold.primary,\n    lime.primary,\n    cyan.primary,\n    geekblue.primary,\n    purple.primary,\n    magenta.primary\n  ];\n\n  return colors[index % colors.length];\n}\n\n// Custom layer for Nivo Line that allows us to display predictions as dashed\n// lines.\nconst DashedLine = ({ series, lineGenerator, xScale, yScale }) => {\n  return series.map(({ id, data, color, predicted, distancing }) => {\n    let style = {\n      strokeWidth: 3\n    };\n\n    // Add custom style if predicted.\n    if (predicted) {\n      if (distancing) {\n        style.strokeDasharray = \"6, 4\";\n      } else {\n        // Display a sparser pattern for no social distancing.\n        style.strokeDasharray = \"2, 6\";\n      }\n    }\n\n    return (\n      <path\n        key={id}\n        d={lineGenerator(\n          data.map(d => ({\n            x: xScale(d.data.x),\n            y: yScale(d.data.y)\n          }))\n        )}\n        fill=\"none\"\n        stroke={color}\n        style={style}\n      />\n    );\n  });\n};\n\nconst theme = {\n  axis: {\n    ticks: {\n      text: {\n        fontSize: 18\n      }\n    },\n    legend: {\n      text: {\n        fontSize: 18\n      }\n    }\n  },\n  legends: {\n    text: {\n      fontSize: 18\n    }\n  }\n};\n\nclass Covid19Graph extends Component {\n  parseDate(dateStr) {\n    let [year, month, day] = dateStr.split(\"-\").map(Number);\n    // Month in JS is 0-based.\n    month -= 1;\n    return new Date(year, month, day);\n  }\n\n  /**\n   * Given a time series returned by the predict endpoint, getCumulativeData\n   * returns it in Nivo format.\n   */\n  getCumulativeData(data) {\n    return data.map(d => ({\n      x: this.parseDate(d.date),\n      y: d.value\n    }));\n  }\n\n  /**\n   * Given a time series returned by the predict endpoint, getDeltaData returns\n   * the adjacent difference of the timeseries, in Nivo format.\n   * @param initialVal - The initial value that is subtracted from the 1st\n   *  element.\n   */\n  getDeltaData(data, initialVal) {\n    return data.map((d, i) => {\n      if (i === 0) {\n        return {\n          x: this.parseDate(d.date),\n          y: d.value - initialVal\n        };\n      }\n\n      return {\n        x: this.parseDate(d.date),\n        y: d.value - data[i - 1].value\n      };\n    });\n  }\n\n  // processData properly formats the given data, and performs special\n  // operations based on parameter values.\n  processData(data, params) {\n    const { statistic, yScale, initialVal } = params;\n\n    // Determine whether we need to calculate deltas between points.\n    let retData =\n      statistic === \"delta\"\n        ? this.getDeltaData(data, initialVal)\n        : this.getCumulativeData(data);\n\n    // Remove all points with y = 0 if we're using log scale, otherwise it will\n    // break.\n    if (yScale === \"log\") {\n      retData = retData.filter(({ x, y }) => y > 0);\n    }\n\n    return retData;\n  }\n\n  /**\n   * getDataMax returns the maximum value present in the data supplied to the\n   * graph.\n   */\n  getDataMax() {\n    const { data } = this.props;\n\n    let max = 0;\n\n    Object.keys(data).forEach(area => {\n      const { observed, predictions } = data[area];\n      max = Math.max(max, Math.max(...observed.map(({ value }) => value)));\n\n      predictions.forEach(p => {\n        const timeSeries = p.time_series;\n        max = Math.max(max, Math.max(...timeSeries.map(({ value }) => value)));\n      });\n    });\n\n    return max;\n  }\n\n  /**\n   * getYAxisProps returns the corresponding Nivo line props for supporting\n   * different Y axis types (linear and log).\n   */\n  getYAxisProps() {\n    const { statistic, yScale } = this.props;\n\n    const linearAxisLeft = {\n      // Format large y numbers as their abbreviations.\n      format: y => numeral(y).format(\"0.[0]a\"),\n      orient: \"left\",\n      tickSize: 5,\n      tickPadding: 5,\n      tickRotation: 0,\n      legend: statistic === \"delta\" ? \"New Cases\" : \"Cumulative Cases\",\n      legendOffset: -60,\n      legendPosition: \"middle\"\n    };\n\n    let logTickValues = [];\n    for (let i = 0; i <= Math.ceil(Math.log10(this.getDataMax())); i++) {\n      logTickValues.push(Math.pow(10, i));\n    }\n\n    // The 'axisLeft' prop for log scale is the same as for linear axis, except\n    // that the tick values must be supplied.\n    const logAxisLeft = {\n      ...linearAxisLeft,\n      tickValues: logTickValues\n    };\n\n    // For log scale Y axes, we must supply the Y tick values for the grid, as\n    // well as specifying the min/ max, since it seems like Nivo cannot\n    // automatically determine the domain for log scale.\n    if (yScale === \"log\") {\n      return {\n        axisLeft: logAxisLeft,\n        gridYValues: logTickValues,\n        yScale: {\n          type: \"log\",\n          base: 10,\n          min: Math.min(...logTickValues),\n          max: Math.max(...logTickValues)\n        }\n      };\n    }\n\n    return {\n      axisLeft: linearAxisLeft,\n      yScale: {\n        type: \"linear\",\n        min: \"auto\",\n        max: \"auto\"\n      }\n    };\n  }\n\n  render() {\n    let { data } = this.props;\n    const { statistic, yScale } = this.props;\n\n    // chartData contains the data that we will pass into Nivo line chart.\n    let chartData = [];\n    // colors holds hex values for each line in the chart.\n    let colors = [];\n\n    // Sort the data by area name (so we have a consistent coloring) and then\n    // loop over each area.\n    Object.keys(data)\n      .sort()\n      .forEach((area, idx) => {\n        const lineColor = getLineColor(idx);\n\n        const observedData = data[area].observed;\n\n        // Add the observed infection data.\n        chartData.push({\n          id: area,\n          data: this.processData(observedData, {\n            statistic: statistic,\n            yScale: yScale,\n            initialVal: 0\n          }),\n          // 'predicted' is a custom prop that we add so later we can tell the\n          // difference between observed/predicted data when drawing the lines.\n          predicted: false\n        });\n\n        colors.push(lineColor);\n\n        // Add the data for each of the predicted time series. Filter out time\n        // series that don't have any data associated.\n        data[area].predictions\n          .filter(p => p.time_series.length > 0)\n          .forEach(p => {\n            const modelName = p.model.name;\n            const distancing = p.distancing;\n            const timeSeries = p.time_series;\n\n            chartData.push({\n              id: `${area} (${p.model.name}, distancing=${distancing})`,\n              // If we're displaying deltas, we pass in the last observed value as\n              // the initial value for calculating the predicted deltas.\n              data: this.processData(timeSeries, {\n                statistic: statistic,\n                yScale: yScale,\n                initialVal: observedData[observedData.length - 1].value\n              }),\n              // 'predicted' is a custom prop that we add so later we can tell the\n              // difference between observed/predicted data when drawing the lines.\n              predicted: true,\n              // 'distancing' is also a custom prop we add so we can draw the\n              // line patterns differently between yes/no social distancing.\n              distancing: distancing\n            });\n\n            colors.push(lineColor);\n          });\n      });\n\n    // Determine whether we need to show weeks or months on the X axis.\n    let tickValues = \"every week\";\n\n    if (chartData.length > 0) {\n      // Calculate the minimum and maximum dates present in the data.\n      let minDate = chartData[0].data[0].x;\n      let maxDate = chartData[0].data[0].x;\n\n      chartData.forEach(({ data }) => {\n        data.forEach(({ x }) => {\n          minDate = Math.min(minDate, x);\n          maxDate = Math.max(maxDate, x);\n        });\n      });\n\n      minDate = moment(minDate);\n      maxDate = moment(maxDate);\n\n      // Switch to 'every month' if the date range is over a certain threshold.\n      const diffInDays = maxDate.diff(minDate, \"days\");\n      if (diffInDays > 150) {\n        tickValues = \"every month\";\n      }\n    }\n\n    return (\n      <ResponsiveLine\n        data={chartData}\n        colors={colors}\n        //50,50,50,80\n        margin={{ top: 10, right: 50, bottom: 70, left: 100 }}\n        xScale={{\n          type: \"time\",\n          format: \"native\",\n          precision: \"day\"\n        }}\n        axisBottom={{\n          // tickValues determines how often / with what values our 'format'\n          // func is called.\n          tickValues: tickValues,\n          // A custom 'format' func is required since all the x values are\n          // javascript Date objects.\n          format: date => {\n            return moment(date).format(\"M/D\");\n          },\n          orient: \"bottom\",\n          tickSize: 5,\n          tickPadding: 5,\n          tickRotation: 0,\n          legend: \"Date\",\n          legendOffset: 36,\n          legendPosition: \"middle\"\n        }}\n        // Set up the Y axis.\n        {...this.getYAxisProps()}\n        enableSlices=\"x\"\n        sliceTooltip={({ slice }) => {\n          return (\n            <div\n              style={{\n                background: \"white\",\n                padding: \"9px 12px\",\n                border: \"1px solid #ccc\"\n              }}\n            >\n              <div>\n                {// Grab the date from the first point, this will be the title of\n                // the tooltip.\n                moment(slice.points[0].data.x).format(\"MMM Do YYYY\")}\n              </div>\n              {slice.points.map(point => (\n                <div\n                  key={point.id}\n                  style={{\n                    color: point.serieColor,\n                    padding: \"3px 0\"\n                  }}\n                >\n                  <strong>{point.serieId}</strong>[\n                  {numeral(point.data.yFormatted).format(\"0.[0]a\")}]\n                </div>\n              ))}\n            </div>\n          );\n        }}\n        pointSize={0}\n        pointLabel=\"y\"\n        pointLabelYOffset={-12}\n        legends={[\n          {\n            anchor: \"top-left\",\n            direction: \"column\",\n            justify: false,\n            translateX: 0,\n            translateY: 0,\n            itemsSpacing: 0,\n            itemDirection: \"left-to-right\",\n            itemWidth: 80,\n            itemHeight: 20,\n            itemOpacity: 0.75,\n            symbolSize: 12,\n            symbolShape: \"circle\",\n            symbolBorderColor: \"rgba(0, 0, 0, .5)\",\n            effects: [\n              {\n                on: \"hover\",\n                style: {\n                  itemBackground: \"rgba(0, 0, 0, .03)\",\n                  itemOpacity: 1\n                }\n              }\n            ]\n          }\n        ]}\n        layers={[\n          \"grid\",\n          \"markers\",\n          \"areas\",\n          \"crosshair\",\n          DashedLine,\n          \"slices\",\n          \"points\",\n          \"axes\",\n          \"legends\"\n        ]}\n        theme={theme}\n      />\n    );\n  }\n}\n\nexport default Covid19Graph;\n","import axios from \"axios\";\n\n// TODO: Update with actual backend URL once backend is up and running.\nconst API_BASE_URL = process.env.REACT_APP_BACKEND_BASE_URL;\n\nclass ModelAPI {\n  affected_by(callback) {}\n\n  areas(callback) {\n    const endpoint = `${API_BASE_URL}/areas`;\n    axios.get(endpoint).then(res => {\n      const allAreas = res.data;\n      callback(allAreas);\n    });\n  }\n\n  models(callback) {\n    const endpoint = `${API_BASE_URL}/models`;\n    axios.get(endpoint).then(res => {\n      const allModels = res.data;\n      callback(allModels);\n    });\n  }\n\n  cumulative_infections(callback) {\n    const endpoint = `${API_BASE_URL}/cumulative_infections`;\n    axios.get(endpoint).then(res => callback(res.data));\n  }\n\n  /**\n   * Params should have 'days', 'model'\n   */\n  predict_all(params, callback) {\n    const endpoint = `${API_BASE_URL}/predict_all`;\n    axios.get(endpoint, {\n      params: params\n    }).then(res => callback(res.data));\n  }\n\n  /**\n   * Params should have 'country', 'state', 'days', 'distancingOn,' 'distancingOff'\n   */\n  predict(params, callback) {\n    const endpoint = `${API_BASE_URL}/predict`;\n    axios\n      .get(endpoint, {\n        params: params\n      })\n      .then(res => {\n        //console.log(res.data);\n        callback(res.data);\n      });\n  }\n\n  // get the current date of observed data\n  getCurrentDate(callback) {\n    const endpoint =  `${API_BASE_URL}/current_date`;\n    axios.get(endpoint).then(res => {\n      const currentDate = res.data;\n      callback(currentDate);\n    });\n  }\n\n  //check previous data \n  checkHistory(params,callback)\n  {\n    const endpoint = `${API_BASE_URL}/check_history`;\n    axios\n      .get(endpoint, {\n        params: params\n      })\n      .then(res => {\n        callback(res.data);\n      });\n  }\n\n  //cumulative for history\n  history_cumulative(params, callback) {\n    const endpoint = `${API_BASE_URL}/history_cumulative`;\n    axios\n      .get(endpoint, {\n        params: params\n      })\n      .then(res => {\n        callback(res.data);\n      });\n  }\n\n  //get all quarantine score at a week, parameter: weeks\n  scores_all(params, callback) {\n    const endpoint = `${API_BASE_URL}/scores_all`;\n    axios\n      .get(endpoint, {\n        params: params\n      })\n      .then(res => {\n        callback(res.data);\n      });\n  }\n\n  //get all, parameter: state, country, weeks\n  scores(params, callback) {\n    const endpoint = `${API_BASE_URL}/scores`;\n    axios\n      .get(endpoint, {\n        params: params\n      })\n      .then(res => {\n        callback(res.data);\n      });\n  }\n\n  //get the latest date which \n  latest_score_date(callback) {\n    const endpoint =  `${API_BASE_URL}/latest_score_date`;\n    axios.get(endpoint).then(res => {\n      const latestDate = res.data;\n      callback(latestDate);\n    });\n  }\n}\n\nexport default ModelAPI;\n","export function areaToStr(a) {\n  return `${a.country}${a.state ? \" / \" + a.state : \"\"}`;\n}\n\nexport function strToArea(s) {\n  const words = s.split(\"/\");\n\n  return {\n    country: words[0].trim(),\n    state: words.length === 2 ? words[1].trim() : \"\"\n  };\n}\n\nexport function modelToStr(a) {\n  return `${a.name}`;\n}\n","import React, { Component } from \"react\";\nimport { Circle, Map, Marker, Popup, TileLayer } from \"react-leaflet\";\nimport ModelAPI from \"./modelapi\";\nimport { areaToStr, strToArea } from \"./covid19util\";\n\nimport * as am4core from \"@amcharts/amcharts4/core\";\nimport * as am4maps from \"@amcharts/amcharts4/maps\";\nimport am4geodata_worldLow from \"@amcharts/amcharts4-geodata/worldLow\";\nimport am4geodata_usaLow from \"@amcharts/amcharts4-geodata/usaLow\";\nimport am4geodata_chinaLow from \"@amcharts/amcharts4-geodata/chinaLow\";\nimport am4geodata_canadaLow from \"@amcharts/amcharts4-geodata/canadaLow\";\nimport am4geodata_australiaLow from \"@amcharts/amcharts4-geodata/australiaLow\";\nimport am4themes_animated from \"@amcharts/amcharts4/themes/animated\";\n\nconst HEAT_MAP_MIN_COLOR = \"#fcbba0\";\nconst HEAT_MAP_MAX_COLOR = \"#66000d\";\nconst MAP_HOVER_COLOR = \"#e43027\";\n\nam4core.useTheme(am4themes_animated);\n\nclass Covid19Map extends Component {\n  constructor() {\n    super();\n    this.modelAPI = new ModelAPI();\n\n    this.state = {\n      areasList : [],\n      showState: false\n    }\n\n    this.modelAPI.areas(allAreas =>\n      this.setState({\n        areasList: allAreas\n      })\n    );\n  }\n\n  componentDidMount() {\n    this.props.triggerRef(this);\n    this.fetchData(this.props.dynamicMapOn);\n  }\n\n  onShowState = (value) =>{\n    this.setState({\n      showState: value\n    });\n  }\n\n  fetchData(dynamicMapOn) {\n    if (!dynamicMapOn || this.props.model === \"\") {\n      //without dynamic map,show to cumulative cases to date\n      this.modelAPI.cumulative_infections(cumulativeInfections => {\n        console.log(cumulativeInfections);\n        let heatmapData = cumulativeInfections.map(d => {\n          return {\n            id: d.area.iso_2,\n            // Adjust all heatmap values by log scale.\n            value: d.value > 0 ? Math.log(d.value) : 0,\n            // Store the true value so we can display tooltips correctly.\n            valueTrue: d.value,\n            area: d.area\n          };\n        });\n        this.setState({ heatmapData }, this.createChart);\n      });\n    } else {\n      //with dynamic map \n      if (this.props.statistic === \"cumulative\"){\n        if (this.props.days > 0)\n        {\n          this.modelAPI.predict_all({\n            days: this.props.days,\n            model: this.props.model\n          }, cumulativeInfections => {\n            console.log(cumulativeInfections);\n            let heatmapData = cumulativeInfections.map(d => {\n              return {\n                id: d.area.iso_2,\n                // Adjust all heatmap values by log scale.\n                value: d.value > 0 ? Math.log(d.value) : 0,\n                // Store the true value so we can display tooltips correctly.\n                valueTrue: d.value,\n                area: d.area\n              };\n            });\n            this.setState({ heatmapData }, this.resetChart);\n          });\n        }\n        else\n        {\n          // show history cumulative\n          this.modelAPI.history_cumulative({\n            days: this.props.days\n          }, historyCumulative => {\n            let heatmapData = historyCumulative.map(d => {\n              return {\n                id: d.area.iso_2,\n                // Adjust all heatmap values by log scale.\n                value: d.value > 0 ? Math.log(d.value) : 0,\n                // Store the true value so we can display tooltips correctly.\n                valueTrue: d.value,\n                area: d.area\n              };\n            });\n            this.setState({ heatmapData }, this.resetChart);\n          });\n\n        }\n      }\n      else\n      {\n        //new cases\n        if (this.props.days>0)\n        {\n          //prediction\n          this.modelAPI.predict_all({\n            days: this.props.days,\n            model: this.props.model\n          }, cumulativeInfections => {\n            //if days is one, we need data from days = 0, which is in history_cumulative\n            if (this.props.days > 1)\n            {\n              this.modelAPI.predict_all({\n                days: this.props.days - 1,\n                model: this.props.model\n              }, previousCumulative =>{\n                let heatmapData = cumulativeInfections.map((d, index) =>{\n                  return {\n                    id: d.area.iso_2,\n                    value: d.value - previousCumulative[index].value > 0 ? Math.log(d.value - previousCumulative[index].value): 0,\n                    valueTrue:  d.value - previousCumulative[index].value,\n                    area: d.area\n                  }\n                });\n                this.setState({ heatmapData }, this.resetChart);\n              });\n            }\n            else\n            {\n              this.modelAPI.history_cumulative({\n                days: this.props.days - 1\n              }, previousCumulative =>{\n                let heatmapData = cumulativeInfections.map((d, index) =>{\n                  return {\n                    id: d.area.iso_2,\n                    value: d.value - previousCumulative.find(x => x.area.iso_2 === d.area.iso_2).value > 0 ? Math.log(d.value - previousCumulative.find(x => x.area.iso_2 === d.area.iso_2).value ): 0,\n                    valueTrue:  d.value - previousCumulative.find(x => x.area.iso_2 === d.area.iso_2).value ,\n                    area: d.area\n                  }\n                });\n                this.setState({ heatmapData }, this.resetChart);\n              });\n            }\n          });\n        }\n        else\n        {\n          //history\n          this.modelAPI.history_cumulative({\n            days: this.props.days,\n            model: this.props.model\n          }, historyInfections => {\n            this.modelAPI.history_cumulative({\n              days: this.props.days - 1,\n              model: this.props.model\n            }, nextDayCumulative =>{\n              let heatmapData = historyInfections.map((d, index) =>{\n                return {\n                  id: d.area.iso_2,\n                  value: d.value - nextDayCumulative[index].value > 0 ? Math.log(d.value - nextDayCumulative[index].value): 0,\n                  valueTrue: d.value - nextDayCumulative[index].value,\n                  area: d.area\n                }\n              });\n              this.setState({ heatmapData }, this.resetChart);\n            });\n          });\n        }\n      }\n      \n    }\n  }\n\n  initChart() {\n    // Create map instance\n    this.chart = am4core.create(\"chartdiv\", am4maps.MapChart);\n    // Set projection\n    this.chart.projection = new am4maps.projections.Mercator();\n  }\n\n  createChartSeries(seriesProps) {\n    const {statistic} = this.props;\n    // Create new map polygon series and copy over all given props.\n    let series = this.chart.series.push(new am4maps.MapPolygonSeries());\n    series = Object.assign(series, seriesProps);\n\n    let polygonTemplate = series.mapPolygons.template;\n\n    // Heatmap fill.\n    if (statistic === \"cumulative\")\n    {\n      series.heatRules.push({\n        property: \"fill\",\n        target: polygonTemplate,\n        min: am4core.color(HEAT_MAP_MIN_COLOR),\n        max: am4core.color(HEAT_MAP_MAX_COLOR),\n        minValue: 0,\n        maxValue: Math.log(5000000)\n      });\n    }\n    else \n    {\n      series.heatRules.push({\n        property: \"fill\",\n        target: polygonTemplate,\n        min: am4core.color(HEAT_MAP_MIN_COLOR),\n        max: am4core.color(HEAT_MAP_MAX_COLOR),\n        minValue: 0,\n        maxValue: Math.log(1000000)\n      });\n    }\n    \n\n    // Configure series tooltip. Display the true value of infections.\n    polygonTemplate.tooltipText = \"{name}: {valueTrue}\";\n    polygonTemplate.nonScalingStroke = true;\n    polygonTemplate.strokeWidth = 0.5;\n\n    // Create hover state and set alternative fill color.\n    let hs = polygonTemplate.states.create(\"hover\");\n    hs.properties.fill = am4core.color(MAP_HOVER_COLOR);\n\n    // Change mouse cursor to pointer.\n    polygonTemplate.cursorOverStyle = am4core.MouseCursorStyle.pointer;\n\n    // Create click handler. Apparently ALL the series in the chart must have\n    // click handlers activated, so if this function is not running double-check\n    // that other series also have click handlers.\n    const { onMapClick, onNoData} = this.props;\n    polygonTemplate.events.on(\"hit\", e => {\n      const { id, value, area, name} = e.target.dataItem.dataContext;\n      if (area){\n        onMapClick(area);\n      }\n      else\n      {\n        onNoData(name);\n      }\n    });\n\n    return series;\n  }\n\n  initChartInterface() {\n    // Create a zoom control.\n    this.chart.zoomControl = new am4maps.ZoomControl();\n    this.chart.zoomControl.cursorOverStyle = am4core.MouseCursorStyle.pointer;\n\n    // Create a toggle button to show/hide states/provinces.\n    let button = this.chart.chartContainer.createChild(am4core.Button);\n    button.label.text = \"Show States/Provinces\";\n    button.togglable = true;\n    button.padding(5, 5, 5, 5);\n    button.align = \"right\";\n    button.marginRight = 15;\n    button.cursorOverStyle = am4core.MouseCursorStyle.pointer;\n    button.events.on(\"hit\", () => {\n      this.onShowState(button.isActive);\n      const {showState} = this.state;\n      this.stateSeries.forEach(s => (s.disabled = !showState));\n      button.label.text = `${\n        showState ? \"Hide\" : \"Show\"\n        } States/Provinces`;\n    });\n  }\n\n  createChart() {\n    const { heatmapData } = this.state;\n\n    this.initChart();\n\n    const worldSeries = this.createChartSeries({\n      geodata: am4geodata_worldLow,\n      exclude: [\"AQ\"],\n      data: heatmapData\n    });\n\n    const chinaSeries = this.createChartSeries({\n      geodata: am4geodata_chinaLow,\n      data: heatmapData,\n      disabled: !this.state.showState\n    });\n\n    const usaSeries = this.createChartSeries({\n      geodata: am4geodata_usaLow,\n      data: heatmapData,\n      disabled: !this.state.showState\n    });\n\n    const canadaSeries = this.createChartSeries({\n      geodata: am4geodata_canadaLow,\n      data: heatmapData,\n      disabled: !this.state.showState\n    });\n\n    const australiaSeries = this.createChartSeries({\n      geodata: am4geodata_australiaLow,\n      data: heatmapData,\n      disabled: !this.state.showState\n    });\n\n    this.stateSeries = [chinaSeries, usaSeries, canadaSeries, australiaSeries];\n\n    this.initChartInterface();\n\n    // worldSeries.data = [\n    // {\n    //   id: \"US\",\n    //   disabled: true\n    // },\n    // {\n    //   id: \"China\",\n    //   disabled: true\n    // }\n    // ];\n\n    // Set up heat legend\n    // let heatLegend = this.chart.createChild(am4maps.HeatLegend);\n    // heatLegend.series = worldSeries;\n    // heatLegend.align = \"right\";\n    // heatLegend.valign = \"bottom\";\n    // heatLegend.width = am4core.percent(20);\n    // heatLegend.marginRight = am4core.percent(4);\n    // heatLegend.minValue = 0;\n    // heatLegend.maxValue = Math.max(...heatmapData.map(d => d.valueTrue));\n    //\n    // // Set up custom heat map legend labels using axis ranges\n    // let minRange = heatLegend.valueAxis.axisRanges.create();\n    // minRange.value = heatLegend.minValue;\n    // minRange.label.text = heatLegend.minValue;\n    // let maxRange = heatLegend.valueAxis.axisRanges.create();\n    // maxRange.value = heatLegend.maxValue;\n    // maxRange.label.text = heatLegend.maxValue;\n    //\n    // // Blank out internal heat legend value axis labels\n    // heatLegend.valueAxis.renderer.labels.template.adapter.add(\"text\", function(\n    //   labelText\n    // ) {\n    //   return \"\";\n    // });\n  }\n\n  resetChart() {\n    const { heatmapData } = this.state;\n\n    const worldSeries = this.createChartSeries({\n      geodata: am4geodata_worldLow,\n      exclude: [\"AQ\"],\n      data: heatmapData\n    });\n\n    const usaSeries = this.createChartSeries({\n      geodata: am4geodata_usaLow,\n      data: heatmapData,\n      disabled: !this.state.showState\n    });\n\n    this.stateSeries = [usaSeries];\n\n  }\n\n  componentWillUnmount() {\n    if (this.chart) {\n      this.chart.dispose();\n    }\n  }\n\n  render() {\n    \n    return <div id=\"chartdiv\"></div>;\n  }\n}\n\nexport default Covid19Map;\n","import React, { PureComponent } from \"react\";\nimport Covid19Graph from \"./covid19graph\";\nimport Covid19Map from \"./covid19map\";\nimport ModelAPI from \"./modelapi\";\nimport { areaToStr, strToArea, modelToStr } from \"./covid19util\";\nimport { test_data } from \"./test_data\";\nimport \"./covid19predict.css\";\n\nimport {\n  Form,\n  Select,\n  InputNumber,\n  Button,\n  Radio,\n  Checkbox,\n  Slider,\n  Tooltip,\n  Switch,\n  Popover,\n  Alert,\n  Row,\n  Col\n} from \"antd\";\n\n\nimport {\n  InfoCircleOutlined\n} from '@ant-design/icons';\n\nconst { Option } = Select;\n\nclass Covid19Predict extends PureComponent {\n  handleYScaleSelect = e => {\n    this.setState({\n      yScale: e.target.value\n    });\n  };\n\n  handleStatisticSelect = e => {\n    this.setState({\n      statistic: e.target.value\n    }, () => {\n      this.reloadAll();\n    });\n\n  };\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      areas: this.props.areas || [],\n      areasList: [],\n      models: this.props.models || ['No under-reported cases(default)'],\n      modelsList: [],\n      currentDate: \"\",\n      distancingOn: true,\n      distancingOff: false,\n      mainGraphData: {},\n      days: 0,\n      dynamicMapOn: false,\n      statistic: \"cumulative\",\n      yScale: \"linear\",\n      noDataError: false,\n      errorDescription: \"\"\n    };\n\n    this.addAreaByStr = this.addAreaByStr.bind(this);\n    this.removeAreaByStr = this.removeAreaByStr.bind(this);\n    this.onValuesChange = this.onValuesChange.bind(this);\n    this.onMapClick = this.onMapClick.bind(this);\n    this.onDaysToPredictChange = this.onDaysToPredictChange.bind(this);\n    this.switchDynamicMap = this.switchDynamicMap.bind(this);\n    this.onAlertClose = this.onAlertClose.bind(this);\n    this.onNoData = this.onNoData.bind(this);\n    this.generateMarks = this.generateMarks.bind(this);\n  }\n\n  componentWillMount = ()=>{\n    this.addAreaByStr('US');\n\n    this.formRef = React.createRef();\n\n    this.modelAPI = new ModelAPI();\n\n    this.modelAPI.areas(allAreas =>\n      this.setState({\n        areasList: allAreas\n      })\n    );\n\n    this.modelAPI.models(allModels =>\n      this.setState({\n        modelsList: allModels\n      })\n    );\n\n    this.modelAPI.getCurrentDate(currentDate => \n      this.setState({\n        currentDate: currentDate[0].date\n      })\n    );\n  }\n\n  onMapClick(area) {\n    if (!this.areaIsSelected(area)) {\n      this.addAreaByStr(areaToStr(area));\n    }\n  }\n\n  /**\n   * Returns true if the area is already selected by the user.\n   */\n  areaIsSelected(area) {\n    if (this.state.areas && area) {\n      const newAreaStr = areaToStr(area);\n      return this.state.areas.includes(newAreaStr);\n    }\n    return false;\n  }\n\n  addAreaByStr(areaStr) {\n    const areaObj = strToArea(areaStr);\n\n    this.setState(\n      prevState => ({\n        areas: [...prevState.areas, areaStr]\n      }),\n      () => {\n        // check if days is positive or negative to decide whether check history or predict future\n        if (this.state.days >= 0){\n          this.modelAPI.predict(\n            {\n              state: areaObj.state,\n              country: areaObj.country,\n              models: this.state.models,\n              days: this.state.days,\n              distancingOn: this.state.distancingOn,\n              distancingOff: this.state.distancingOff\n            },\n            data => {\n              this.setState(prevState => ({\n                mainGraphData: {\n                  ...prevState.mainGraphData,\n                  [areaStr]: data\n                }\n              }));\n            }\n          );\n        }\n        else{\n          this.modelAPI.checkHistory(\n            {\n              state: areaObj.state,\n              country: areaObj.country,\n              days: this.state.days\n            }, \n            data =>{\n              this.setState(prevState => ({\n                mainGraphData: {\n                  ...prevState.mainGraphData,\n                  [areaStr]: data\n                }\n              }));\n            }\n\n          );\n        }\n\n        this.formRef.current.setFieldsValue({\n          areas: this.state.areas\n        });\n      }\n    );\n  }\n\n  removeAreaByStr(targetAreaStr) {\n    this.setState(prevState => {\n      return {\n        // Filter out the area / graph data corresponding to the target area\n        // string.\n        areas: prevState.areas.filter(areaStr => areaStr !== targetAreaStr),\n        mainGraphData: Object.keys(prevState.mainGraphData)\n          .filter(areaStr => areaStr !== targetAreaStr)\n          .reduce((newMainGraphData, areaStr) => {\n            return {\n              ...newMainGraphData,\n              [areaStr]: prevState.mainGraphData[areaStr]\n            };\n          }, {})\n      };\n    });\n  }\n\n  /**\n   * Returns true if the model is already selected by the user.\n   */\n  modelIsSelected(model) {\n    if (this.state.models && model) {\n      const newModelStr = modelToStr(model);\n      return this.state.models.includes(newModelStr);\n    }\n    return false;\n  }\n\n  /**\n   * onValuesChange is called whenever the values in the form change. Note that\n   * days to predict is handled separately by onDaysToPredictChange.\n   */\n  onValuesChange(changedValues, allValues) {\n    if (\"socialDistancing\" in changedValues || \"models\" in changedValues) {\n      // If either the social distancing or model parameters were changed, we\n      // clear our data and do a full reload. We purposely ignore days to\n      // predict here (see onDaysToPredictChange).\n\n      this.setState(\n        {\n          models: allValues.models,\n          distancingOn: allValues.socialDistancing.includes(\"distancingOn\"),\n          distancingOff: allValues.socialDistancing.includes(\"distancingOff\")\n        },\n        () => {\n          this.reloadAll();\n        }\n      );\n    } else {\n      // If we're here it means the user either added or deleted an area, so we\n      // can do a union / intersection to figure out what to add/remove.\n      const prevAreas = this.state.areas;\n      const newAreas = allValues.areas;\n\n      const areasToAdd = newAreas.filter(\n        areaStr => !prevAreas.includes(areaStr)\n      );\n      const areasToRemove = prevAreas.filter(\n        areaStr => !newAreas.includes(areaStr)\n      );\n\n      areasToAdd.forEach(this.addAreaByStr);\n      areasToRemove.forEach(this.removeAreaByStr);\n    }\n  }\n\n  /**\n   * onDaysToPredictChange is bound to the 'onAfterChange' prop for the\n   * slider component, so this function will only be called on the mouseup\n   * event (to reduce database load).\n   */\n  onDaysToPredictChange(days) {\n    const prevAreas = this.state.areas;\n    this.setState({ days }, () => {\n      this.reloadAll();\n    });\n  }\n\n  // Set the reference to the map component as a child-component.\n  bindRef = ref => { \n    this.map = ref \n  }\n\n  /**\n   * reloadAll refreshes the prediction data for all currently-selected\n   * countries.\n   */\n  reloadAll() {\n    const prevAreas = this.state.areas;\n    this.setState(\n      {\n        areas: [],\n        mainGraphData: {}\n      },\n      () => {\n        // Add all the areas back.\n        prevAreas.forEach(this.addAreaByStr);\n\n        // TODO: Add code for stuff after reload here!\n        // Force reload the heatmap, only refetch data when dynamic map is on\n        if (this.state.dynamicMapOn && this.state.models.length !== 0) {\n          this.map.fetchData(this.state.dynamicMapOn);\n        }\n\n      }\n    );\n  }\n\n  switchDynamicMap(checked) {\n    this.setState({\n      dynamicMapOn: checked\n    });\n    this.map.fetchData(checked);\n  }\n\n  //when closing the alert\n  onAlertClose = ()=>{\n    this.setState({\n      noDataError: false\n    });\n  }\n\n  //when encounter an no data error\n  onNoData = (name) =>{\n    this.setState({\n      noDataError: true,\n      errorDescription: `There is currently no data for ${name}`\n    })\n  }\n\n  generateMarks = ()=>{\n    const {currentDate, days} = this.state;\n    let date = new Date(`${currentDate}T00:00`);\n    let firstDate = new Date(2020,0,22);\n    //get the date of the selected date on slider\n    date.setDate(date.getDate(Date) + days);\n    let marks = {};\n    marks[days] = `${date.getMonth()+1}/${date.getDate()}`;\n    // marks for future\n    let i = days+7\n    while (i < days+50 && i<=99)\n    {\n       date.setDate(date.getDate() + 7);\n       marks[i] = `${date.getMonth()+1}/${date.getDate()}`;\n       i+=7;\n    }\n    // marks for history\n    date = new Date(`${currentDate}T00:00`);\n    date.setDate(date.getDate(Date) + days);\n    date.setDate(date.getDate() - 7);\n    i = days-7;\n    while (date >= firstDate && i > days-30){\n      marks[i] = `${date.getMonth()+1}/${date.getDate()}`;\n      date.setDate(date.getDate() - 7);\n      i -= 7;\n    }\n    return marks;\n  }\n\n  getDaysToFirstDate = ()=>{\n    const {currentDate} = this.state;\n    let date = new Date(`${currentDate}T00:00`);\n    let firstDate = new Date(2020,0,22);\n    return Math.ceil(Math.abs(date - firstDate)/ (1000 * 60 * 60 * 24));\n  }\n\n  render() {\n    const {\n      areas,\n      areasList,\n      models,\n      modelsList,\n      days,\n      mainGraphData,\n      dynamicMapOn,\n      statistic,\n      yScale,\n      noDataError,\n      errorDescription\n    } = this.state;\n    console.log(mainGraphData);\n    const marks = this.generateMarks();\n    const daysToFirstDate = this.getDaysToFirstDate();\n    // Only show options for countries that have not been selected yet.\n    const countryOptions = areasList\n      .filter(area => !this.areaIsSelected(area))\n      .map(areaToStr)\n      .sort()\n      .map(s => {\n        return <Option key={s}> {s} </Option>;\n      });\n\n    const modelOptions = modelsList\n      .filter(model => !this.modelIsSelected(model))\n      .map(model => {\n        return (\n          <Option key={model.name}>\n            <Tooltip title={model.description} placement=\"right\">\n              {model.name}\n            </Tooltip>\n          </Option>\n        );\n      });\n\n      // The clarification message to be shown for the \"social distancing\" option.\n      const SOCIAL_DISTANCING_CLARIFICATION = (\n        <p>\n          The trend until March 18th has been used as a proxy for \"Social distancing off\". <br />\n          For modeling details, please see: \n          <a href=\"https://arxiv.org/abs/2004.11372\"> https://arxiv.org/abs/2004.11372</a>.\n        </p>\n      );\n    return (\n      <div className=\"covid-19-predict\">\n        <Row type=\"flex\" justify=\"space-around\" align=\"middle\">\n        {/* <div className=\"left-col\"> */}\n        <Col span={10}>\n        {noDataError?\n          <Alert\n          message= {`${errorDescription}`}\n          description= \"Please wait for our updates.\"\n          type=\"error\"\n          closable\n          onClose={this.onAlertClose}\n        />: null\n        }\n          <div className=\"form-wrapper\">\n            <Form\n              ref={this.formRef}\n              onValuesChange={this.onValuesChange}\n              initialValues={{\n                areas: areas,\n                models: models,\n                days: 0,\n                socialDistancing: [\"distancingOn\"]\n              }}\n            >\n              <Form.Item\n                label=\"Areas\"\n                name=\"areas\"\n                rules={[{ required: true, message: \"Please select areas!\" }]}\n              >\n                <Select\n                  mode=\"multiple\"\n                  style={{ width: \"100%\" }}\n                  placeholder=\"Select Areas\"\n                >\n                  {countryOptions}\n                </Select>\n              </Form.Item>\n              <Form.Item\n                label=\"Under-reporting Cases:\"\n                name=\"models\"\n                rules={[\n                  { required: true, message: \"Please select reporting ratio!\" }\n                ]}\n              >\n                <Select\n                  mode=\"multiple\"\n                  style={{ width: \"100%\" }}\n                  placeholder=\"Select Reporting Ratio\"\n                >\n                  {modelOptions}\n                </Select>\n              </Form.Item>\n              <Form.Item\n                label=\"Date to Predict\"\n                name=\"days\"\n                rules={[\n                  { required: true, message: \"Please select number of days!\" }\n                ]}\n              >\n                <Slider\n                  marks={marks}\n                  min={days-30>=-daysToFirstDate?days-30:-daysToFirstDate}\n                  initialValue={days}\n                  max={days+50<=99?days+50:99}\n                  onAfterChange={this.onDaysToPredictChange}\n                />\n              </Form.Item>\n\n              <Popover \n                content={SOCIAL_DISTANCING_CLARIFICATION} \n                title=\"Social Distancing Clarification\"\n                placement=\"topLeft\"\n              >\n              <Form.Item label=\"Social Distancing\" name=\"socialDistancing\">\n                <Checkbox.Group>\n                  <Checkbox defaultChecked value=\"distancingOn\">\n                    Current Trend\n                  </Checkbox>\n                  <Checkbox value=\"distancingOff\"> \n                    Social Distancing Off\n                  </Checkbox>\n                </Checkbox.Group>\n              </Form.Item>\n              </Popover>\n            </Form>\n            <div>Statistic:&nbsp;&nbsp;  \n              <Radio.Group\n                value={statistic}\n                onChange={this.handleStatisticSelect}\n              >\n                <Radio value=\"cumulative\">Cumulative Cases</Radio>\n                <Radio value=\"delta\">New Cases</Radio>\n              </Radio.Group>\n            </div>\n            <br />\n            <div>\n              Scale:&nbsp;&nbsp;  \n              <Radio.Group value={yScale} onChange={this.handleYScaleSelect}>\n                <Radio value=\"linear\">linear</Radio>\n                <Radio value=\"log\">logarithmic</Radio>\n              </Radio.Group>\n            </div>\n            <br />\n            <p>\n              Dynamic Map:&nbsp;&nbsp;  \n              <Switch \n                onChange={this.switchDynamicMap} \n              />\n            </p>\n          </div>\n        </Col>\n        <Col span={14}>\n          <div className=\"map-wrapper\">\n            <Covid19Map className=\"map\"\n              triggerRef={this.bindRef}\n              dynamicMapOn={dynamicMapOn}\n              days={days}\n              model={this.state.models == null || this.state.models.length ===0? \"\" : this.state.models[this.state.models.length-1]}\n              onMapClick={this.onMapClick} \n              onNoData = {this.onNoData}\n              statistic={statistic}\n            />\n          </div>\n        {/* </div> */}\n        </Col>\n        </Row>\n        {areas.length?\n          <Row>\n          <Col span={24}>\n          {/* <div className=\"right-col\"> */}\n            <div className=\"graph-wrapper\">\n              <Covid19Graph\n                data={mainGraphData}\n                statistic={statistic}\n                yScale={yScale}\n              ></Covid19Graph>\n            </div>\n          {/* </div> */}\n          </Col>\n          </Row>\n        : null}\n      </div>\n    );\n  }\n}\n\nexport default Covid19Predict;\n","import React, { Component } from \"react\";\nimport {\n    Layout,\n    Row,\n    Col,\n} from 'antd';\nimport \"./aboutus.css\";\nimport \"./covid19app.css\";\n\nclass AboutUs extends Component {\n    render() {\n        return (\n            <div className=\"page-wrapper\">\n                <div className=\"article\">\n                    <h1 className=\"article-title\">ReCOVER: Accurate Predictions and Resource Management for COVID-19 Epidemic Response</h1>\n                    <p className=\"article-paragraph\">\n                        Accurate forecasts of COVID-19 is central to resource management and building strategies to deal with the epidemic. \n                        This is a NSF-funded project on COVID-19 forecasting directed \n                        by Viktor K. Prasanna (<a className=\"article-anchor\" href=\"mailto:prasanna@usc.edu\">prasanna@usc.edu</a>) and\n                        Ajitesh Srivastava (<a className=\"article-anchor\" href=\"mailto:ajiteshs@usc.edu\">ajiteshs@usc.edu</a>) \n                        from the Data Science Lab in the University of Southern California. \n                    </p>\n                    <h2>Our Model</h2>\n                    <p className=\"article-paragraph\">\n                        We use our own epidemic model called SI-kJalpha -- Heterogeneous Infection Rate with Human Mobility, which is a \n                        preliminary version of what we have successfully used \n                        during <a className=\"article-anchor\" href=\"https://news.usc.edu/83180/usc-engineers-earn-national-recognition-for-predicting-disease-outbreaks/\" target=\"_blank\">\n                            DARPA Grand Challenge 2014\n                        </a>.  \n                        By linearizing the model and using weighted least squares, \n                        our model is able to quickly adapt to changing trends and provide extremely accurate predictions of confirmed cases \n                        at the level of countries and states of the United States. Training the model to forecast also enables learning characteristics \n                        of the epidemic. In particular, we have shown that changes in model parameters over time can help us quantify how well a state \n                        or a country has responded to the epidemic. The variations in parameters also allow us to forecast different scenarios such as \n                        what would happen if we were to disregard social distancing suggestions. \n                        This work is supported by National Science Foundation Award No. 2027007 (RAPID)\n                    </p>\n                    <p className=\"article-paragraph\">\n                        Details of our initial approach can be found in our <a className=\"article-anchor\" href=\"https://www.youtube.com/watch?v=ll6k8wlxOFo\" target=\"_blank\">webinar</a>.\n                    </p>\n                    <p className=\"article-paragraph\">\n                        The Github repository for this project is <a className=\"article-anchor\" href=\"https://github.com/scc-usc/ReCOVER-COVID-19\" target=\"_blank\">publicly available</a> .\n                    </p>\n                    <p className=\"article-paragraph\">\n                        The matlab code for forecasting is also made available on <a className=\"article-anchor\" href=\"https://www.mathworks.com/matlabcentral/fileexchange/75281-recover\" target=\"_blank\">File Exchange</a>.\n                    </p>\n                    <p className=\"article-paragraph\">\n                        The code of the prediction model and this web application is contributed by Ajitesh Srivastava, Jamin Chen, and Frost Tianjian Xu.\n                    </p>\n                    <h2>USC Data Science Lab</h2>\n                    <p className=\"article-paragraph\">\n                        The USC Data Science Lab focuses on applying machine learning, data mining, \n                        and network analysis to real-world problems in society and industry. \n                        Please find more information and other research projects <a className=\"article-anchor\" href=\"https://sites.usc.edu/dslab/\" target=\"_blank\"> on \n                        our website</a>.\n                    </p>\n                    <h2>Related Publications</h2>\n                    <p className=\"disclaimer\">\n                        <b>Disclaimer:</b> The following papers may have copyright restrictions. Downloads will have to adhere to these restrictions. \n                        They may not be reposted without explicit permission from the copyright holder. Any opinions, findings, and conclusions or \n                        recommendations expressed in these materials are those of the author(s) and do not necessarily reflect the views of the sponsors \n                        including National Science Foundation (NSF), Defense Advanced Research Projects Agency (DARPA), and any other sponsors listed in \n                        the publications.\n                    </p>\n                    <ol className=\"article-paragraph\">\n                        <li>\n                            Ajitesh Srivastava and Viktor K. Prasanna, \n                            <a className=\"article-anchor\" href=\"https://arxiv.org/abs/2004.11372\" target=\"_blank\"> Learning to Forecast and Forecasting to Learn from the COVID-19 Pandemic</a> [arXiv].\n                        </li>\n                    </ol>\n\n\n                    \n\n\n\n\n                </div>\n            </div>\n\n        );\n    }\n}\n\nexport default AboutUs;","import React, { Component } from \"react\";\nimport { Circle, Map, Marker, Popup, TileLayer } from \"react-leaflet\";\nimport ModelAPI from \"../modelapi\";\nimport { areaToStr, strToArea } from \"../covid19util\";\n\nimport * as am4core from \"@amcharts/amcharts4/core\";\nimport * as am4maps from \"@amcharts/amcharts4/maps\";\nimport am4geodata_worldLow from \"@amcharts/amcharts4-geodata/worldLow\";\nimport am4geodata_usaLow from \"@amcharts/amcharts4-geodata/usaLow\";\nimport am4geodata_chinaLow from \"@amcharts/amcharts4-geodata/chinaLow\";\nimport am4geodata_canadaLow from \"@amcharts/amcharts4-geodata/canadaLow\";\nimport am4geodata_australiaLow from \"@amcharts/amcharts4-geodata/australiaLow\";\nimport am4themes_animated from \"@amcharts/amcharts4/themes/animated\";\n\nconst HEAT_MAP_MIN_COLOR = \"#fcbba0\";\nconst HEAT_MAP_MAX_COLOR = \"#66000d\";\nconst MAP_HOVER_COLOR = \"#e43027\";\n\nam4core.useTheme(am4themes_animated);\n\nclass ScoreMap extends Component {\n    constructor() {\n      super();\n      this.modelAPI = new ModelAPI();\n  \n      this.state = {\n        areasList : [],\n        showState: false\n      }\n  \n      this.modelAPI.areas(allAreas =>\n        this.setState({\n          areasList: allAreas\n        })\n      );\n    }\n\n    componentDidMount() {\n        this.props.triggerRef(this);\n    }\n\n    onShowState = (value) =>{\n        this.setState({\n          showState: value\n        });\n    }\n\n    fetchData(dynamicMapOn)\n    {\n        if (!dynamicMapOn) {\n          //without dynamic map,show to latestscore\n          this.modelAPI.scores_all(\n            {\n                weeks: this.props.latestWeek,\n            } , scores => {\n              let heatmapData = scores.map(d => {\n              return {\n                id: d.area.iso_2,\n                // Adjust all heatmap values by log scale.\n                value: d.value > 0 ? d.value: 0,\n                area: d.area,\n                conf: d.conf\n              };\n            });\n            this.setState({ heatmapData }, this.createChart);\n          });\n        } else {\n            this.modelAPI.scores_all(\n            {\n                weeks: this.props.weeks,\n            }, scores =>{\n            let heatmapData = scores.map(d => {\n                return {\n                    id: d.area.iso_2,\n                    // Adjust all heatmap values by log scale.\n                    value: d.value > 0 ? d.value: 0,\n                    area: d.area\n                };\n                });\n                this.setState({ heatmapData }, this.createChart);\n            });\n        }\n    }\n\n    initChart() {\n        // Create map instance\n        this.chart = am4core.create(\"chartdiv\", am4maps.MapChart);\n        // Set projection\n        this.chart.projection = new am4maps.projections.Mercator();\n    }\n\n    createChartSeries(seriesProps) {\n        const {statistic} = this.props;\n        // Create new map polygon series and copy over all given props.\n        let series = this.chart.series.push(new am4maps.MapPolygonSeries());\n        series = Object.assign(series, seriesProps);\n    \n        let polygonTemplate = series.mapPolygons.template;\n    \n      \n        series.heatRules.push({\n            property: \"fill\",\n            target: polygonTemplate,\n            min: am4core.color(HEAT_MAP_MIN_COLOR),\n            max: am4core.color(HEAT_MAP_MAX_COLOR),\n            minValue: 0,\n            maxValue: 10\n        });\n\n        \n        // Configure series tooltip. Display the true value of infections.\n        polygonTemplate.tooltipText = \"{name}: {value} (conf: {conf})\";\n        polygonTemplate.nonScalingStroke = true;\n        polygonTemplate.strokeWidth = 0.5;\n    \n        // Create hover state and set alternative fill color.\n        let hs = polygonTemplate.states.create(\"hover\");\n        hs.properties.fill = am4core.color(MAP_HOVER_COLOR);\n    \n        // Change mouse cursor to pointer.\n        polygonTemplate.cursorOverStyle = am4core.MouseCursorStyle.pointer;\n    \n        // Create click handler. Apparently ALL the series in the chart must have\n        // click handlers activated, so if this function is not running double-check\n        // that other series also have click handlers.\n        const { onMapClick, onNoData} = this.props;\n        polygonTemplate.events.on(\"hit\", e => {\n          const { id, value, area, name} = e.target.dataItem.dataContext;\n          if (area){\n            onMapClick(area);\n          }\n          else\n          {\n            onNoData(name);\n          }\n        });\n        return series;\n    }\n\n    initChartInterface() {\n        // Create a zoom control.\n        this.chart.zoomControl = new am4maps.ZoomControl();\n        this.chart.zoomControl.cursorOverStyle = am4core.MouseCursorStyle.pointer;\n    \n        // Create a toggle button to show/hide states/provinces.\n        let button = this.chart.chartContainer.createChild(am4core.Button);\n        button.label.text = \"Show States/Provinces\";\n        button.togglable = true;\n        button.padding(5, 5, 5, 5);\n        button.align = \"right\";\n        button.marginRight = 15;\n        button.cursorOverStyle = am4core.MouseCursorStyle.pointer;\n        button.events.on(\"hit\", () => {\n          this.onShowState(button.isActive);\n          const {showState} = this.state;\n          this.stateSeries.forEach(s => (s.disabled = !showState));\n          button.label.text = `${\n            showState ? \"Hide\" : \"Show\"\n            } States/Provinces`;\n        });\n      }\n    \n      createChart() {\n        const { heatmapData } = this.state;\n    \n        this.initChart();\n    \n        const worldSeries = this.createChartSeries({\n          geodata: am4geodata_worldLow,\n          exclude: [\"AQ\"],\n          data: heatmapData\n        });\n    \n        // const chinaSeries = this.createChartSeries({\n        //   geodata: am4geodata_chinaLow,\n        //   data: heatmapData,\n        //   disabled: !this.state.showState\n        // });\n    \n        const usaSeries = this.createChartSeries({\n          geodata: am4geodata_usaLow,\n          data: heatmapData,\n          disabled: !this.state.showState\n        });\n    \n        // const canadaSeries = this.createChartSeries({\n        //   geodata: am4geodata_canadaLow,\n        //   data: heatmapData,\n        //   disabled: !this.state.showState\n        // });\n    \n        // const australiaSeries = this.createChartSeries({\n        //   geodata: am4geodata_australiaLow,\n        //   data: heatmapData,\n        //   disabled: !this.state.showState\n        // });\n    \n        //this.stateSeries = [chinaSeries, usaSeries, canadaSeries, australiaSeries];\n        this.stateSeries = [usaSeries]\n    \n        this.initChartInterface();\n      }\n    \n      resetChart() {\n        const { heatmapData } = this.state;\n    \n        const worldSeries = this.createChartSeries({\n          geodata: am4geodata_worldLow,\n          exclude: [\"AQ\"],\n          data: heatmapData\n        });\n    \n        const usaSeries = this.createChartSeries({\n          geodata: am4geodata_usaLow,\n          data: heatmapData,\n          disabled: !this.state.showState\n        });\n    \n        this.stateSeries = [usaSeries];\n    \n      }\n\n      componentWillUnmount() {\n        if (this.chart) {\n          this.chart.dispose();\n        }\n      }\n\n    render() {\n        return <div id=\"chartdiv\"></div>;\n    }\n}\n\nexport default ScoreMap;","import React, { PureComponent } from \"react\";\nimport ModelAPI from \"../modelapi\";\nimport { areaToStr, strToArea} from \"../covid19util\";\nimport Covid19Graph from \"../covid19graph\";\nimport ScoreMap from './scoreMap';\nimport \"./scorePage.css\";\n\nimport {\n    Form,\n    Select,\n    InputNumber,\n    Button,\n    Radio,\n    Checkbox,\n    Slider,\n    Tooltip,\n    Switch,\n    Popover,\n    Alert,\n    Row,\n    Col\n  } from \"antd\";\n\nconst { Option } = Select;\n\nclass ScorePage extends PureComponent{\n    constructor(props){\n        super(props);\n        this.state = {\n            areas: this.props.areas || [],\n            areasList: [],\n            latestDate: \"\",\n            mainGraphData: {},\n            weeks: this.props.weeks || 0, // will later be set to be the weeks to the latest date as initial value\n            latestWeek: 0, //will change later and remain unchange until database updated\n            dynamicMapOn: false,\n            noDataError: false,\n            errorDescription: \"\"\n        }  \n        \n        this.addAreaByStr = this.addAreaByStr.bind(this);\n        this.removeAreaByStr = this.removeAreaByStr.bind(this);\n        this.onValuesChange = this.onValuesChange.bind(this);\n        this.onMapClick = this.onMapClick.bind(this);\n        this.onWeeksChange = this.onWeeksChange.bind(this);\n        this.switchDynamicMap = this.switchDynamicMap.bind(this);\n        this.onAlertClose = this.onAlertClose.bind(this);\n        this.onNoData = this.onNoData.bind(this);\n        this.generateMarks = this.generateMarks.bind(this);\n    }\n\n    componentDidMount = ()=>{\n        this.formRef = React.createRef();\n    \n        this.modelAPI = new ModelAPI();\n\n        this.modelAPI.latest_score_date(latestDate => \n            this.setState({\n                latestDate: latestDate[0].date,\n                weeks: latestDate[0].weeks,\n                latestWeek: latestDate[0].weeks\n            }, ()=>{\n                this.addAreaByStr('US');\n                this.formRef.current.setFieldsValue({\n                    weeks: this.state.latestWeek,\n                });\n                this.map.fetchData(this.state.dynamicMapOn);\n            })\n        );\n    \n        this.modelAPI.areas(allAreas =>\n          this.setState({\n            areasList: allAreas\n          })\n        );\n    }\n\n    onMapClick(area) {\n        if (!this.areaIsSelected(area)) {\n            this.addAreaByStr(areaToStr(area));\n        }\n    }\n\n    areaIsSelected(area) {\n        if (this.state.areas && area) {\n          const newAreaStr = areaToStr(area);\n          return this.state.areas.includes(newAreaStr);\n        }\n        return false;\n    }\n\n    addAreaByStr(areaStr) {\n        const areaObj = strToArea(areaStr);\n    \n        this.setState(\n          prevState => ({\n            areas: [...prevState.areas, areaStr]\n          }),\n          () => {\n            this.modelAPI.scores(\n            {\n                state: areaObj.state,\n                country: areaObj.country,\n                weeks: this.state.weeks,\n            },\n            data => {\n                this.setState(prevState => ({\n                mainGraphData: {\n                    ...prevState.mainGraphData,\n                    [areaStr]: data\n                }\n                }));\n            }\n            );\n\n            this.formRef.current.setFieldsValue({\n              areas: this.state.areas\n            });\n          }\n        );\n    }\n    \n    removeAreaByStr(targetAreaStr) {\n        this.setState(prevState => {\n          return {\n            // Filter out the area / graph data corresponding to the target area\n            // string.\n            areas: prevState.areas.filter(areaStr => areaStr !== targetAreaStr),\n            mainGraphData: Object.keys(prevState.mainGraphData)\n              .filter(areaStr => areaStr !== targetAreaStr)\n              .reduce((newMainGraphData, areaStr) => {\n                return {\n                  ...newMainGraphData,\n                  [areaStr]: prevState.mainGraphData[areaStr]\n                };\n              }, {})\n          };\n        });\n    }\n    \n    onValuesChange(changedValues, allValues) {\n        // If we're here it means the user either added or deleted an area, so we\n        // can do a union / intersection to figure out what to add/remove.\n        const prevAreas = this.state.areas;\n        const newAreas = allValues.areas;\n\n        const areasToAdd = newAreas.filter(\n        areaStr => !prevAreas.includes(areaStr)\n        );\n        const areasToRemove = prevAreas.filter(\n        areaStr => !newAreas.includes(areaStr)\n        );\n\n        areasToAdd.forEach(this.addAreaByStr);\n        areasToRemove.forEach(this.removeAreaByStr);\n    }\n\n    onWeeksChange(weeks) {\n        this.setState({ weeks }, () => {\n          this.reloadAll();\n        });\n    }\n\n    bindRef = ref => { \n        this.map = ref \n    }\n\n    reloadAll() {\n        const prevAreas = this.state.areas;\n        this.setState(\n          {\n            areas: [],\n            mainGraphData: {}\n          },\n          () => {\n            // Add all the areas back.\n            prevAreas.forEach(this.addAreaByStr);\n    \n            // TODO: Add code for stuff after reload here!\n            // Force reload the heatmap, only refetch data when dynamic map is on\n            if (this.state.dynamicMapOn) {\n              this.map.fetchData(this.state.dynamicMapOn);\n            }\n    \n          }\n        );\n    }\n\n    switchDynamicMap(checked) {\n        this.setState({\n          dynamicMapOn: checked\n        });\n        this.map.fetchData(checked);\n    }\n\n    //when closing the alert\n    onAlertClose = ()=>{\n        this.setState({\n        noDataError: false\n        });\n    }\n\n    //when encounter an no data error\n    onNoData = (name) =>{\n        this.setState({\n        noDataError: true,\n        errorDescription: `There is currently no data for ${name}`\n        })\n    }\n\n    generateMarks = ()=>{\n        const {latestDate} = this.state;\n        let lastDate = new Date(`${latestDate}T00:00`);\n        let date = new Date(2020,2,11);\n        //get the date of the selected date on slider\n        let marks = {};\n        let i = 0;\n        while (date <= lastDate)\n        {\n           marks[i] = `${date.getMonth()+1}/${date.getDate()}`;\n           date.setDate(date.getDate(Date) + 7);\n           i++;\n        }\n        return marks;\n      }\n\n    render(){\n        const {\n            areas,\n            areasList,\n            weeks,\n            mainGraphData,\n            dynamicMapOn,\n            latestWeek,\n            noDataError,\n            errorDescription\n          } = this.state;\n        const countryOptions = areasList\n        .filter(area => !this.areaIsSelected(area))\n        .map(areaToStr)\n        .sort()\n        .map(s => {\n        return <Option key={s}> {s} </Option>;\n        });\n\n        const marks = this.generateMarks();\n        return(\n            <div className=\"score-page\">\n                <Row type=\"flex\" justify=\"space-around\">\n                <Col span={10}>\n                    {noDataError?\n                        <Alert\n                        message= {`${errorDescription}`}\n                        description= \"Please wait for our updates.\"\n                        type=\"error\"\n                        closable\n                        onClose={this.onAlertClose}\n                        />: null\n                    }\n                    <div className=\"form-wrapper\">\n                        <Form\n                            ref={this.formRef}\n                            onValuesChange={this.onValuesChange}\n                        >\n                            <Form.Item\n                                label=\"Areas\"\n                                name=\"areas\"\n                                rules={[{ required: true, message: \"Please select areas!\" }]}\n                            >\n                                <Select\n                                mode=\"multiple\"\n                                style={{ width: \"100%\" }}\n                                placeholder=\"Select Areas\"\n                                >\n                                {countryOptions}\n                                </Select>\n                            </Form.Item>\n\n                            <Form.Item\n                                label=\"Week to check\"\n                                name=\"weeks\"\n                                rules={[\n                                { required: true, message: \"Please select the week you want to see\" }\n                                ]}\n                            >\n                                <Slider\n                                    marks={marks}\n                                    min= {0}\n                                    initialValue={latestWeek}\n                                    max={latestWeek}\n                                    onAfterChange={this.onWeeksChange}\n                                />\n                            </Form.Item>\n                        </Form>\n                        <p>\n                        Dynamic Map:&nbsp;&nbsp;  \n                        <Switch \n                            onChange={this.switchDynamicMap} \n                        />\n                        </p>\n                    </div>\n                </Col>\n                <Col span={14}>\n                <div className=\"map-wrapper\">\n                    <ScoreMap className=\"score-map\"\n                    triggerRef={this.bindRef}\n                    dynamicMapOn={dynamicMapOn}\n                    weeks={weeks}\n                    latestWeek={latestWeek - 1}\n                    onMapClick={this.onMapClick} \n                    onNoData = {this.onNoData}\n                    />\n                </div>\n                {/* </div> */}\n                </Col>\n                </Row>\n                {areas.length?\n                <Row>\n                <Col span={24}>\n                {/* <div className=\"right-col\"> */}\n                    <div className=\"graph-wrapper\">\n                    <Covid19Graph\n                        data={mainGraphData}\n                        statistic={\"cumulative\"}\n                        yScale={\"linear\"}\n                    ></Covid19Graph>\n                    </div>\n                {/* </div> */}\n                </Col>\n                </Row>\n                : null}\n            </div>\n        );\n    }\n}\n\nexport default ScorePage;","import React, { Component } from \"react\";\nimport {\n    Menu,\n    Row,\n    Col\n} from 'antd';\nimport \"./navbar.css\";\n\nclass NavBar extends Component {\n\n    constructor(props){\n        super(props);\n        this.state = {\n            activateItem: 'forecast'\n        };\n    }\n\n    handleItemClick = (e) => \n    {\n        const {redirectForecast, redirectAbout, redirectScore} = this.props;\n        const {key} = e;\n        this.setState({\n            activeItem: e.key\n        });\n        if (key === \"forecast\")\n        {\n            redirectForecast();\n        }\n        else if (key === \"information\")\n        {\n            redirectAbout();\n        }\n        else\n        {\n            redirectScore();\n        }\n    }\n\n    render() {\n        return (\n            <Row className=\"navbar-container\">\n            <Col >\n                <img\n                    className=\"logo\"\n                    src=\"https://identity.usc.edu/files/2011/12/combo_gold_white_cardinal.png\"\n                    alt=\"USC\"\n                />\n            </Col>\n            <Col>\n                <Menu theme=\"light\"\n                    mode=\"horizontal\"\n                    onClick={this.handleItemClick}\n                    defaultSelectedKeys={['forecast']}>\n                    <Menu.Item key=\"forecast\">COVID-19 Forecast</Menu.Item>\n                    <Menu.Item key=\"information\">About Us</Menu.Item>\n                    <Menu.Item key=\"quarantine-score\">Quarantine Score</Menu.Item>\n                </Menu>\n            </Col>\n        </Row>\n        );\n    }\n}\n\nexport default NavBar;","import React, { Component } from \"react\";\nimport Covid19Predict from \"./covid19predict\";\nimport AboutUS from \"./aboutus\";\nimport ScorePage from './scorePage/scorePage';\nimport {BrowserRouter as Router, Route, Redirect, Switch} from 'react-router-dom'; \nimport Navbar from \"./navbar/navbar\";\nimport 'semantic-ui-css/semantic.min.css';\nimport \"./covid19app.css\";\n\nclass Covid19App extends Component {\n  constructor(props){\n    super(props);\n    this.state = {\n      redirectForecast: false,\n      redirectAbout: false,\n      redirectScore: false\n    }\n  }\n\n  redirectForecast = ()=>{\n    this.setState({\n      redirectForecast:true,\n      redirectAbout: false,\n      redirectScore: false\n    });\n  }\n\n  redirectAbout = ()=>{\n    this.setState({\n      redirectForecast: false,\n      redirectAbout:true,\n      redirectScore: false\n    });\n  }\n\n  redirectScore = ()=>{\n    this.setState({\n      redirectForecast: false,\n      redirectAbout:false,\n      redirectScore: true\n    });\n  }\n\n  render() {\n    const {redirectForecast, redirectAbout, redirectScore} = this.state;\n    return (\n      <Router>\n        {redirectForecast?<Redirect to=\"/ReCOVER-COVID-19\"/>:null}\n        {redirectAbout?<Redirect to=\"/ReCOVER-COVID-19/about\"/>:null}\n        {redirectScore?<Redirect to=\"/ReCOVER-COVID-19/score\"/>:null}\n        <Navbar redirectForecast = {this.redirectForecast}\n                redirectAbout = {this.redirectAbout}\n                redirectScore = {this.redirectScore}\n        />\n        <Switch>\n          <Route exact path='/ReCOVER-COVID-19' \n            render={(props) => <Covid19Predict {...props} />}/>\n          <Route exact path='/ReCOVER-COVID-19/about'\n            render={(props) => <AboutUS {...props} />} />\n          <Route exact path='/ReCOVER-COVID-19/score' \n            render={(props) => <ScorePage {...props}/>}\n          />\n          {/* need a page for instruction */}\n        </Switch>\n      </Router>\n    );\n  }\n}\n\nexport default Covid19App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport Covid19App from \"./covid19app\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(<Covid19App />, document.getElementById(\"root\"));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}