(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{425:function(e,a,t){},493:function(e,a,t){e.exports=t(761)},498:function(e,a,t){},661:function(e,a,t){},748:function(e,a,t){},749:function(e,a,t){},752:function(e,a,t){},761:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),i=t(38),s=t.n(i),o=(t(498),t(39)),c=t(37),l=t(72),u=t(71),d=(t(289),t(142)),h=(t(291),t(100)),m=(t(352),t(275)),p=(t(501),t(112)),f=(t(503),t(454)),v=(t(505),t(281)),y=(t(353),t(273)),g=(t(354),t(110)),b=(t(355),t(274)),S=(t(292),t(140)),D=t(124),k=t(125),E=t(156),C=t(42),O=(t(426),t(159)),w=t(82),A=t(427),M=t(220),j=t.n(M),_=t(264),I=t.n(_),x=t(144);var V=function(e){var a=e.series,t=e.lineGenerator,n=e.xScale,i=e.yScale;return a.map((function(e){var a=e.id,s=e.data,o=e.color,c=e.predicted,l=e.distancing,u={strokeWidth:3};return c&&(u.strokeDasharray=l?"6, 4":"2, 6"),r.a.createElement("path",{key:a,d:t(s.map((function(e){return{x:n(e.data.x),y:i(e.data.y)}}))),fill:"none",stroke:o,style:u})}))},P={axis:{ticks:{text:{fontSize:18}},legend:{text:{fontSize:18}}},legends:{text:{fontSize:18}}},N=function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(){return Object(o.a)(this,t),a.apply(this,arguments)}return Object(c.a)(t,[{key:"parseDate",value:function(e){var a=e.split("-").map(Number),t=Object(w.a)(a,3),n=t[0],r=t[1],i=t[2];return new Date(n,r-=1,i)}},{key:"getCumulativeData",value:function(e){var a=this;return e.map((function(e){return{x:a.parseDate(e.date),y:e.value}}))}},{key:"getDeltaData",value:function(e,a){var t=this;return e.map((function(n,r){return 0===r?{x:t.parseDate(n.date),y:n.value-a}:{x:t.parseDate(n.date),y:n.value-e[r-1].value}}))}},{key:"processData",value:function(e,a){var t=a.statistic,n=a.yScale,r=a.initialVal,i="delta"===t?this.getDeltaData(e,r):this.getCumulativeData(e);return"log"===n&&(i=i.filter((function(e){e.x;return e.y>0}))),i}},{key:"getDataMax",value:function(){var e=this.props.data,a=0;return Object.keys(e).forEach((function(t){var n=e[t],r=n.observed,i=n.predictions;a=Math.max(a,Math.max.apply(Math,Object(E.a)(r.map((function(e){return e.value}))))),i.forEach((function(e){var t=e.time_series;a=Math.max(a,Math.max.apply(Math,Object(E.a)(t.map((function(e){return e.value})))))}))})),a}},{key:"getYAxisProps",value:function(){for(var e=this.props,a=e.statistic,t=e.yScale,n={format:function(e){return I()(e).format("0.[0]a")},orient:"left",tickSize:5,tickPadding:5,tickRotation:0,legend:"delta"===a?"New Cases":"Cumulative Cases",legendOffset:-60,legendPosition:"middle"},r=[],i=0;i<=Math.ceil(Math.log10(this.getDataMax()));i++)r.push(Math.pow(10,i));var s=Object(k.a)({},n,{tickValues:r});return"log"===t?{axisLeft:s,gridYValues:r,yScale:{type:"log",base:10,min:Math.min.apply(Math,r),max:Math.max.apply(Math,r)}}:{axisLeft:n,yScale:{type:"linear",min:"auto",max:"auto"}}}},{key:"render",value:function(){var e=this,a=this.props.data,t=this.props,n=t.statistic,i=t.yScale,s=t.dataType,o=[],c=[];Object.keys(a).sort().forEach((function(t,r){var l=function(e){var a=[x.red.primary,x.gold.primary,x.lime.primary,x.cyan.primary,x.geekblue.primary,x.purple.primary,x.magenta.primary];return a[e%a.length]}(r),u="confirmed"==s?a[t].observed:a[t].observed_deaths;o.push({id:t,data:e.processData(u,{statistic:n,yScale:i,initialVal:0}),predicted:!1}),c.push(l),a[t].predictions.filter((function(e){return e.time_series.length>0})).forEach((function(a){a.model.name;var r=a.distancing,s=a.time_series;o.push({id:"".concat(t," (").concat(a.model.name,", distancing=").concat(r,")"),data:e.processData(s,{statistic:n,yScale:i,initialVal:u[u.length-1].value}),predicted:!0,distancing:r}),c.push(l)}))}));var l="every week";if(o.length>0){var u=o[0].data[0].x,d=o[0].data[0].x;o.forEach((function(e){e.data.forEach((function(e){var a=e.x;u=Math.min(u,a),d=Math.max(d,a)}))})),u=j()(u),(d=j()(d)).diff(u,"days")>150&&(l="every month")}return r.a.createElement(A.a,Object.assign({data:o,colors:c,margin:{top:10,right:50,bottom:70,left:100},xScale:{type:"time",format:"native",precision:"day"},axisBottom:{tickValues:l,format:function(e){return j()(e).format("M/D")},orient:"bottom",tickSize:5,tickPadding:5,tickRotation:0,legend:"Date",legendOffset:36,legendPosition:"middle"}},this.getYAxisProps(),{enableSlices:"x",sliceTooltip:function(e){var a=e.slice;return r.a.createElement("div",{style:{background:"white",padding:"9px 12px",border:"1px solid #ccc"}},r.a.createElement("div",null,j()(a.points[0].data.x).format("MMM Do YYYY")),a.points.map((function(e){return r.a.createElement("div",{key:e.id,style:{color:e.serieColor,padding:"3px 0"}},r.a.createElement("strong",null,e.serieId),"[",I()(e.data.yFormatted).format("0.[0]a"),"]")})))},pointSize:0,pointLabel:"y",pointLabelYOffset:-12,legends:[{anchor:"top-left",direction:"column",justify:!1,translateX:0,translateY:0,itemsSpacing:0,itemDirection:"left-to-right",itemWidth:80,itemHeight:20,itemOpacity:.75,symbolSize:12,symbolShape:"circle",symbolBorderColor:"rgba(0, 0, 0, .5)",effects:[{on:"hover",style:{itemBackground:"rgba(0, 0, 0, .03)",itemOpacity:1}}]}],layers:["grid","markers","areas","crosshair",V,"slices","points","axes","legends"],theme:P}))}}]),t}(n.Component),T=t(76),R=t.n(T),B="https://dslab-covid19-backend.herokuapp.com/api",F=function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,[{key:"affected_by",value:function(e){}},{key:"areas",value:function(e){var a="".concat(B,"/areas");R.a.get(a).then((function(a){var t=a.data;e(t)}))}},{key:"models",value:function(e){var a="".concat(B,"/models");R.a.get(a).then((function(a){var t=a.data;e(t)}))}},{key:"infection_models",value:function(e){var a="".concat(B,"/infection_models");R.a.get(a).then((function(a){var t=a.data;e(t)}))}},{key:"death_models",value:function(e){var a="".concat(B,"/death_models");R.a.get(a).then((function(a){var t=a.data;e(t)}))}},{key:"cumulative_infections",value:function(e){var a="".concat(B,"/cumulative_infections");R.a.get(a).then((function(a){return e(a.data)}))}},{key:"predict_all",value:function(e,a){var t="".concat(B,"/predict_all");R.a.get(t,{params:e}).then((function(e){return a(e.data)}))}},{key:"predict",value:function(e,a){var t="".concat(B,"/predict");R.a.get(t,{params:e}).then((function(e){a(e.data)}))}},{key:"getCurrentDate",value:function(e){var a="".concat(B,"/current_date");R.a.get(a).then((function(a){var t=a.data;e(t)}))}},{key:"checkHistory",value:function(e,a){var t="".concat(B,"/check_history");R.a.get(t,{params:e}).then((function(e){a(e.data)}))}},{key:"history_cumulative",value:function(e,a){var t="".concat(B,"/history_cumulative");R.a.get(t,{params:e}).then((function(e){a(e.data)}))}},{key:"scores_all",value:function(e,a){var t="".concat(B,"/scores_all");R.a.get(t,{params:e}).then((function(e){a(e.data)}))}},{key:"scores",value:function(e,a){var t="".concat(B,"/scores");R.a.get(t,{params:e}).then((function(e){a(e.data)}))}},{key:"latest_score_date",value:function(e){var a="".concat(B,"/latest_score_date");R.a.get(a).then((function(a){var t=a.data;e(t)}))}},{key:"cumulative_death",value:function(e,a){var t="".concat(B,"/cumulative_death");R.a.get(t,{params:e}).then((function(e){a(e.data)}))}}]),e}();function G(e){return"".concat(e.country).concat(e.state?" / "+e.state:"")}function L(e){var a=e.split("/");return{country:a[0].trim(),state:2===a.length?a[1].trim():""}}var W=t(52),Y=t(109),z=t(191),U=t(192),q=t(335),H=t(336),J=t(337),Q=t(276);W.e(Q.a);var X=function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(){var e;return Object(o.a)(this,t),(e=a.call(this)).onShowState=function(a){e.setState({showState:a})},e.modelAPI=new F,e.state={areasList:[],showState:!1},e.modelAPI.areas((function(a){return e.setState({areasList:a})})),e}return Object(c.a)(t,[{key:"componentDidMount",value:function(){this.props.triggerRef(this),this.fetchData(this.props.dynamicMapOn)}},{key:"fetchData",value:function(e){var a=this;e&&""!==this.props.model?"cumulative"===this.props.statistic?this.props.days>0?this.modelAPI.predict_all({days:this.props.days,model:this.props.model},(function(e){console.log(e);var t=e.map((function(e){return{id:e.area.iso_2,value:e.value>0?Math.log(e.value):0,valueTrue:e.value,area:e.area}}));a.setState({heatmapData:t},a.resetChart)})):this.modelAPI.history_cumulative({days:this.props.days},(function(e){var t=e.map((function(e){return"confirmed"===a.props.dataType?{id:e.area.iso_2,value:e.value>0?Math.log(e.value):0,valueTrue:e.value,area:e.area}:{id:e.area.iso_2,value:e.deathValue>0?Math.log(e.deathValue):0,valueTrue:e.deathValue,area:e.area}}));a.setState({heatmapData:t},a.resetChart)})):this.props.days>0?this.modelAPI.predict_all({days:this.props.days,model:this.props.model},(function(e){a.props.days>1?a.modelAPI.predict_all({days:a.props.days-1,model:a.props.model},(function(t){var n=e.map((function(e,a){return{id:e.area.iso_2,value:e.value-t[a].value>0?Math.log(e.value-t[a].value):0,valueTrue:e.value-t[a].value>0?e.value-t[a].value:0,area:e.area}}));a.setState({heatmapData:n},a.resetChart)})):a.modelAPI.history_cumulative({days:a.props.days-1},(function(t){var n=e.map((function(e,n){return"confirmed"===a.props.dataType?{id:e.area.iso_2,value:e.value-t.find((function(a){return a.area.iso_2===e.area.iso_2})).value>0?Math.log(e.value-t.find((function(a){return a.area.iso_2===e.area.iso_2})).value):0,valueTrue:e.value-t.find((function(a){return a.area.iso_2===e.area.iso_2})).value>0?e.value-t.find((function(a){return a.area.iso_2===e.area.iso_2})).value:0,area:e.area}:{id:e.area.iso_2,value:e.deathValue-t.find((function(a){return a.area.iso_2===e.area.iso_2})).deathValue>0?Math.log(e.deathValue-t.find((function(a){return a.area.iso_2===e.area.iso_2})).deathValue):0,valueTrue:e.deathValue-t.find((function(a){return a.area.iso_2===e.area.iso_2})).deathValue>0?e.deathValue-t.find((function(a){return a.area.iso_2===e.area.iso_2})).deathValue:0,area:e.area}}));a.setState({heatmapData:n},a.resetChart)}))})):this.modelAPI.history_cumulative({days:this.props.days,model:this.props.model},(function(e){a.modelAPI.history_cumulative({days:a.props.days-1,model:a.props.model},(function(t){var n=e.map((function(e,n){return"confirmed"===a.props.dataType?{id:e.area.iso_2,value:e.value-t[n].value>0?Math.log(e.value-t[n].value):0,valueTrue:e.value-t[n].value>0?e.value-t[n].value:0,area:e.area}:{id:e.area.iso_2,value:e.deathValue-t[n].deathValue>0?Math.log(e.deathValue-t[n].deathValue):0,valueTrue:e.deathValue-t[n].deathValue>0?e.deathValue-t[n].deathValue:0,area:e.area}}));a.setState({heatmapData:n},a.resetChart)}))})):"confirmed"===this.props.dataType?this.modelAPI.cumulative_infections((function(e){var t=e.map((function(e){return{id:e.area.iso_2,value:e.value>0?Math.log(e.value):0,valueTrue:e.value,area:e.area}}));a.setState({heatmapData:t},a.createChart)})):this.modelAPI.cumulative_death({days:0},(function(e){var t=e.map((function(e){return{id:e.area.iso_2,value:e.value>0?Math.log(e.value):0,valueTrue:e.value,area:e.area}}));a.setState({heatmapData:t},a.createChart)}))}},{key:"initChart",value:function(){this.chart=W.d("chartdiv",Y.a),this.chart.projection=new Y.d.Mercator}},{key:"createChartSeries",value:function(e){var a=this.props.statistic,t=this.chart.series.push(new Y.b),n=(t=Object.assign(t,e)).mapPolygons.template;"cumulative"===a?t.heatRules.push({property:"fill",target:n,min:W.c("#fcbba0"),max:W.c("#66000d"),minValue:0,maxValue:Math.log(5e6)}):t.heatRules.push({property:"fill",target:n,min:W.c("#fcbba0"),max:W.c("#66000d"),minValue:0,maxValue:Math.log(1e6)}),n.tooltipText="{name}: {valueTrue}",n.nonScalingStroke=!0,n.strokeWidth=.5,n.states.create("hover").properties.fill=W.c("#e43027"),n.cursorOverStyle=W.b.pointer;var r=this.props,i=r.onMapClick,s=r.onNoData;return n.events.on("hit",(function(e){var a=e.target.dataItem.dataContext,t=(a.id,a.value,a.area),n=a.name;t?i(t):s(n)})),t}},{key:"initChartInterface",value:function(){var e=this,a=this.state.showState;this.chart.zoomControl=new Y.c,this.chart.zoomControl.cursorOverStyle=W.b.pointer;var t=this.chart.chartContainer.createChild(W.a);t.label.text="".concat(a?"Hide":"Show"," States/Provinces"),t.togglable=!0,t.padding(5,5,5,5),t.align="right",t.marginRight=15,t.cursorOverStyle=W.b.pointer,t.events.on("hit",(function(){e.onShowState(t.isActive);var a=e.state.showState;e.stateSeries.forEach((function(e){return e.disabled=!a})),t.label.text="".concat(a?"Hide":"Show"," States/Provinces")}))}},{key:"createChart",value:function(){var e=this.state.heatmapData;this.initChart();this.createChartSeries({geodata:z.a,exclude:["AQ"],data:e});var a=this.createChartSeries({geodata:q.a,data:e,disabled:!this.state.showState}),t=this.createChartSeries({geodata:U.a,data:e,disabled:!this.state.showState}),n=this.createChartSeries({geodata:H.a,data:e,disabled:!this.state.showState}),r=this.createChartSeries({geodata:J.a,data:e,disabled:!this.state.showState});this.stateSeries=[a,t,n,r],this.initChartInterface()}},{key:"resetChart",value:function(){var e=this.state.heatmapData,a=(this.createChartSeries({geodata:z.a,exclude:["AQ"],data:e}),this.createChartSeries({geodata:U.a,data:e,disabled:!this.state.showState}));this.stateSeries=[a]}},{key:"componentWillUnmount",value:function(){this.chart&&this.chart.dispose()}},{key:"render",value:function(){return r.a.createElement("div",{id:"chartdiv"})}}]),t}(n.Component),K=(t(661),O.a.Option),$=function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(e){var n;return Object(o.a)(this,t),(n=a.call(this,e)).handleYScaleSelect=function(e){n.setState({yScale:e.target.value})},n.handleStatisticSelect=function(e){n.setState({statistic:e.target.value},(function(){n.reloadAll()}))},n.handleDataTypeSelect=function(e){"confirmed"===e.target.value?n.modelAPI.infection_models((function(a){n.setState({modelsList:a,dataType:e.target.value,models:["SI-kJalpha - No under-reported positive cases (default)"]},(function(){n.formRef.current.setFieldsValue({models:n.state.models}),n.reloadAll(),n.state.dynamicMapOn||n.map.fetchData(n.state.dynamicMapOn)}))})):n.modelAPI.death_models((function(a){n.setState({modelsList:a,dataType:e.target.value,models:["SI-kJalpha - No under-reported positive cases (death prediction)"]},(function(){n.formRef.current.setFieldsValue({models:n.state.models}),n.reloadAll(),n.state.dynamicMapOn||n.map.fetchData(n.state.dynamicMapOn)}))}))},n.componentWillMount=function(){n.addAreaByStr("US"),n.formRef=r.a.createRef(),n.modelAPI=new F,n.modelAPI.areas((function(e){return n.setState({areasList:e})})),n.modelAPI.infection_models((function(e){return n.setState({modelsList:e})})),n.modelAPI.getCurrentDate((function(e){return n.setState({currentDate:e[0].date})}))},n.bindRef=function(e){n.map=e},n.onAlertClose=function(){n.setState({noDataError:!1})},n.onNoData=function(e){n.setState({noDataError:!0,errorDescription:"There is currently no data for ".concat(e)})},n.generateMarks=function(){var e=n.state,a=e.currentDate,t=e.days,r=new Date("".concat(a,"T00:00")),i=new Date(2020,0,22);r.setDate(r.getDate(Date)+t);var s={};s[t]="".concat(r.getMonth()+1,"/").concat(r.getDate());for(var o=t+7;o<t+50&&o<=99;)r.setDate(r.getDate()+7),s[o]="".concat(r.getMonth()+1,"/").concat(r.getDate()),o+=7;for((r=new Date("".concat(a,"T00:00"))).setDate(r.getDate(Date)+t),r.setDate(r.getDate()-7),o=t-7;r>=i&&o>t-30;)s[o]="".concat(r.getMonth()+1,"/").concat(r.getDate()),r.setDate(r.getDate()-7),o-=7;return s},n.getDaysToFirstDate=function(){var e=n.state.currentDate,a=new Date("".concat(e,"T00:00")),t=new Date(2020,0,22);return Math.ceil(Math.abs(a-t)/864e5)},n.state={areas:n.props.areas||[],areasList:[],models:n.props.models||["SI-kJalpha - No under-reported positive cases (default)"],modelsList:[],currentDate:"",distancingOn:!0,distancingOff:!1,mainGraphData:{},days:0,dynamicMapOn:!1,dataType:"confirmed",statistic:"cumulative",yScale:"linear",noDataError:!1,errorDescription:""},n.addAreaByStr=n.addAreaByStr.bind(Object(C.a)(n)),n.removeAreaByStr=n.removeAreaByStr.bind(Object(C.a)(n)),n.onValuesChange=n.onValuesChange.bind(Object(C.a)(n)),n.onMapClick=n.onMapClick.bind(Object(C.a)(n)),n.onDaysToPredictChange=n.onDaysToPredictChange.bind(Object(C.a)(n)),n.switchDynamicMap=n.switchDynamicMap.bind(Object(C.a)(n)),n.onAlertClose=n.onAlertClose.bind(Object(C.a)(n)),n.onNoData=n.onNoData.bind(Object(C.a)(n)),n.generateMarks=n.generateMarks.bind(Object(C.a)(n)),n.handleModelChange=n.handleModelChange.bind(Object(C.a)(n)),n.handleDataTypeSelect=n.handleDataTypeSelect.bind(Object(C.a)(n)),n.handleStatisticSelect=n.handleStatisticSelect.bind(Object(C.a)(n)),n.handleYScaleSelect=n.handleYScaleSelect.bind(Object(C.a)(n)),n}return Object(c.a)(t,[{key:"onMapClick",value:function(e){this.areaIsSelected(e)||this.addAreaByStr(G(e))}},{key:"areaIsSelected",value:function(e){if(this.state.areas&&e){var a=G(e);return this.state.areas.includes(a)}return!1}},{key:"addAreaByStr",value:function(e){var a=this,t=L(e);this.setState((function(a){return{areas:[].concat(Object(E.a)(a.areas),[e])}}),(function(){a.state.days>=0?a.modelAPI.predict({state:t.state,country:t.country,models:a.state.models,days:a.state.days,distancingOn:a.state.distancingOn,distancingOff:a.state.distancingOff},(function(t){a.setState((function(a){return{mainGraphData:Object(k.a)({},a.mainGraphData,Object(D.a)({},e,t))}}))})):a.modelAPI.checkHistory({state:t.state,country:t.country,days:a.state.days},(function(t){a.setState((function(a){return{mainGraphData:Object(k.a)({},a.mainGraphData,Object(D.a)({},e,t))}}))})),a.formRef.current.setFieldsValue({areas:a.state.areas})}))}},{key:"removeAreaByStr",value:function(e){this.setState((function(a){return{areas:a.areas.filter((function(a){return a!==e})),mainGraphData:Object.keys(a.mainGraphData).filter((function(a){return a!==e})).reduce((function(e,t){return Object(k.a)({},e,Object(D.a)({},t,a.mainGraphData[t]))}),{})}}))}},{key:"modelIsSelected",value:function(e){if(this.state.models&&e){var a="".concat(e.name);return this.state.models.includes(a)}return!1}},{key:"onValuesChange",value:function(e,a){var t=this;if("socialDistancing"in e)this.setState({distancingOn:a.socialDistancing.includes("distancingOn"),distancingOff:a.socialDistancing.includes("distancingOff")},(function(){t.reloadAll()}));else{var n=this.state.areas,r=a.areas,i=r.filter((function(e){return!n.includes(e)})),s=n.filter((function(e){return!r.includes(e)}));i.forEach(this.addAreaByStr),s.forEach(this.removeAreaByStr)}}},{key:"handleModelChange",value:function(e){var a=this;this.setState({models:e},(function(){a.reloadAll()}))}},{key:"onDaysToPredictChange",value:function(e){var a=this;this.state.areas;this.setState({days:e},(function(){a.reloadAll()}))}},{key:"reloadAll",value:function(){var e=this,a=this.state.areas;this.setState({areas:[],mainGraphData:{}},(function(){a.forEach(e.addAreaByStr),e.state.dynamicMapOn&&0!==e.state.models.length&&e.map.fetchData(e.state.dynamicMapOn)}))}},{key:"switchDynamicMap",value:function(e){this.setState({dynamicMapOn:e}),this.map.fetchData(e)}},{key:"render",value:function(){var e=this,a=this.state,t=a.areas,n=a.areasList,i=a.models,s=a.modelsList,o=a.days,c=a.mainGraphData,l=a.dynamicMapOn,u=a.dataType,D=a.statistic,k=a.yScale,E=a.noDataError,C=a.errorDescription,w=this.generateMarks(),A=this.getDaysToFirstDate(),M=n.filter((function(a){return!e.areaIsSelected(a)})).map(G).sort().map((function(e){return r.a.createElement(K,{key:e}," ",e," ")})),j=s.filter((function(a){return!e.modelIsSelected(a)})).map((function(e){return r.a.createElement(K,{key:e.name,value:e.name},r.a.createElement(S.a,{title:e.description,placement:"right"},e.name))})),_=r.a.createElement("p",null,'The trend until March 18th has been used as a proxy for "Social distancing off". ',r.a.createElement("br",null),"For modeling details, please see:",r.a.createElement("a",{href:"https://arxiv.org/abs/2004.11372"}," https://arxiv.org/abs/2004.11372"),".");return r.a.createElement("div",{className:"covid-19-predict"},r.a.createElement(d.a,{type:"flex",justify:"space-around"},r.a.createElement(h.a,{span:10},E?r.a.createElement(b.a,{message:"".concat(C),description:"Please wait for our updates.",type:"error",closable:!0,onClose:this.onAlertClose}):null,r.a.createElement("div",{className:"form-wrapper"},r.a.createElement(g.a,{ref:this.formRef,onValuesChange:this.onValuesChange,initialValues:{areas:t,models:i,socialDistancing:["distancingOn"]}},r.a.createElement(g.a.Item,{label:"Areas",name:"areas",rules:[{required:!0,message:"Please select areas!"}]},r.a.createElement(O.a,{mode:"multiple",style:{width:"100%"},placeholder:"Select Areas"},M)),r.a.createElement(g.a.Item,{label:"Models:",name:"models",rules:[{required:!0,message:"Please select a prediction model!"}]},r.a.createElement(O.a,{mode:"multiple",style:{width:"100%"},placeholder:"Select Prediction Models",initialvalue:i,onChange:this.handleModelChange},j)),r.a.createElement(g.a.Item,{label:"Date to Predict",name:"days",rules:[{required:!0,message:"Please select number of days!"}]},r.a.createElement(y.a,{marks:w,min:o-30>=-A?o-30:-A,initialValue:o,max:o+50<=99?o+50:99,onAfterChange:this.onDaysToPredictChange})),r.a.createElement(f.a,{content:_,title:"Social Distancing Clarification",placement:"topLeft"},r.a.createElement(g.a.Item,{label:"Social Distancing",name:"socialDistancing"},r.a.createElement(v.a.Group,null,r.a.createElement(v.a,{defaultChecked:!0,value:"distancingOn"},"Current Trend"),r.a.createElement(v.a,{value:"distancingOff"},"Social Distancing Off"))))),r.a.createElement("div",null,"Data Type:\xa0\xa0",r.a.createElement(p.a.Group,{value:u,onChange:this.handleDataTypeSelect},r.a.createElement(p.a,{value:"confirmed"},"Confirmed Cases"),r.a.createElement(p.a,{value:"death"},"Deaths"))),r.a.createElement("br",null),r.a.createElement("div",null,"Statistic:\xa0\xa0",r.a.createElement(p.a.Group,{value:D,onChange:this.handleStatisticSelect},r.a.createElement(p.a,{value:"cumulative"},"Cumulative Cases"),r.a.createElement(p.a,{value:"delta"},"New Cases"))),r.a.createElement("br",null),r.a.createElement("div",null,"Scale:\xa0\xa0",r.a.createElement(p.a.Group,{value:k,onChange:this.handleYScaleSelect},r.a.createElement(p.a,{value:"linear"},"linear"),r.a.createElement(p.a,{value:"log"},"logarithmic"))),r.a.createElement("br",null),r.a.createElement("p",null,"Dynamic Map:\xa0\xa0",r.a.createElement(m.a,{onChange:this.switchDynamicMap})))),r.a.createElement(h.a,{span:14},r.a.createElement("div",{className:"map-wrapper"},r.a.createElement(X,{className:"map",triggerRef:this.bindRef,dynamicMapOn:l,days:o,model:null==this.state.models||0===this.state.models.length?"":this.state.models[this.state.models.length-1],onMapClick:this.onMapClick,onNoData:this.onNoData,statistic:D,dataType:u})))),t.length?r.a.createElement(d.a,null,r.a.createElement(h.a,{span:24},r.a.createElement("div",{className:"graph-wrapper"},r.a.createElement(N,{data:c,dataType:u,onNoData:this.onNoData,statistic:D,yScale:k})))):null)}}]),t}(n.PureComponent),Z=(t(748),t(425),function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(){return Object(o.a)(this,t),a.apply(this,arguments)}return Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"page-wrapper"},r.a.createElement("div",{className:"article"},r.a.createElement("h1",{className:"article-title"},"ReCOVER: Accurate Predictions and Resource Management for COVID-19 Epidemic Response"),r.a.createElement("p",{className:"article-paragraph"},"Accurate forecasts of COVID-19 is central to resource management and building strategies to deal with the epidemic. This is a NSF-funded project on COVID-19 forecasting directed by Viktor K. Prasanna (",r.a.createElement("a",{className:"article-anchor",href:"mailto:prasanna@usc.edu"},"prasanna@usc.edu"),") and Ajitesh Srivastava (",r.a.createElement("a",{className:"article-anchor",href:"mailto:ajiteshs@usc.edu"},"ajiteshs@usc.edu"),") from the Data Science Lab in the University of Southern California."),r.a.createElement("h2",null,"Our Model"),r.a.createElement("p",{className:"article-paragraph"},"We use our own epidemic model called SI-kJalpha -- Heterogeneous Infection Rate with Human Mobility, which is a preliminary version of what we have successfully used during ",r.a.createElement("a",{className:"article-anchor",href:"https://news.usc.edu/83180/usc-engineers-earn-national-recognition-for-predicting-disease-outbreaks/",target:"_blank"},"DARPA Grand Challenge 2014"),". By linearizing the model and using weighted least squares, our model is able to quickly adapt to changing trends and provide extremely accurate predictions of confirmed cases at the level of countries and states of the United States. Training the model to forecast also enables learning characteristics of the epidemic. In particular, we have shown that changes in model parameters over time can help us quantify how well a state or a country has responded to the epidemic. The variations in parameters also allow us to forecast different scenarios such as what would happen if we were to disregard social distancing suggestions. This work is supported by National Science Foundation Award No. 2027007 (RAPID)"),r.a.createElement("p",{className:"article-paragraph"},"Details of our initial approach can be found in our ",r.a.createElement("a",{className:"article-anchor",href:"https://www.youtube.com/watch?v=ll6k8wlxOFo",target:"_blank"},"webinar"),"."),r.a.createElement("p",{className:"article-paragraph"},"The Github repository for this project is ",r.a.createElement("a",{className:"article-anchor",href:"https://github.com/scc-usc/ReCOVER-COVID-19",target:"_blank"},"publicly available")," ."),r.a.createElement("p",{className:"article-paragraph"},"The matlab code for forecasting is also made available on ",r.a.createElement("a",{className:"article-anchor",href:"https://www.mathworks.com/matlabcentral/fileexchange/75281-recover",target:"_blank"},"File Exchange"),"."),r.a.createElement("p",{className:"article-paragraph"},"The code of the prediction model and this web application is contributed by Ajitesh Srivastava, Jamin Chen, Frost Tianjian Xu, and Bob Xiaochen Yang."),r.a.createElement("h2",null,"USC Data Science Lab"),r.a.createElement("p",{className:"article-paragraph"},"The USC Data Science Lab focuses on applying machine learning, data mining, and network analysis to real-world problems in society and industry. Please find more information and other research projects ",r.a.createElement("a",{className:"article-anchor",href:"https://sites.usc.edu/dslab/",target:"_blank"}," on our website"),"."),r.a.createElement("h2",null,"Related Publications"),r.a.createElement("p",{className:"disclaimer"},r.a.createElement("b",null,"Disclaimer:")," The following papers may have copyright restrictions. Downloads will have to adhere to these restrictions. They may not be reposted without explicit permission from the copyright holder. Any opinions, findings, and conclusions or recommendations expressed in these materials are those of the author(s) and do not necessarily reflect the views of the sponsors including National Science Foundation (NSF), Defense Advanced Research Projects Agency (DARPA), and any other sponsors listed in the publications."),r.a.createElement("ol",{className:"article-paragraph"},r.a.createElement("li",null,"Ajitesh Srivastava and Viktor K. Prasanna,",r.a.createElement("a",{className:"article-anchor",href:"https://arxiv.org/abs/2004.11372",target:"_blank"}," \u201cLearning to Forecast and Forecasting to Learn from the COVID-19 Pandemic\u201d")," [arXiv]."))))}}]),t}(n.Component));W.e(Q.a);var ee=function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(){var e;return Object(o.a)(this,t),(e=a.call(this)).onShowState=function(a){e.setState({showState:a})},e.modelAPI=new F,e.state={areasList:[],showState:!1},e.modelAPI.areas((function(a){return e.setState({areasList:a})})),e}return Object(c.a)(t,[{key:"componentDidMount",value:function(){this.props.triggerRef(this)}},{key:"fetchData",value:function(e){var a=this;e?this.modelAPI.scores_all({weeks:this.props.weeks},(function(e){var t=e.map((function(e){return{id:e.area.iso_2,value:e.value>0?e.value:0,area:e.area}}));a.setState({heatmapData:t},a.createChart)})):this.modelAPI.scores_all({weeks:this.props.latestWeek},(function(e){var t=e.map((function(e){return{id:e.area.iso_2,value:e.value>0?e.value:0,area:e.area,conf:e.conf}}));a.setState({heatmapData:t},a.createChart)}))}},{key:"initChart",value:function(){this.chart=W.d("chartdiv",Y.a),this.chart.projection=new Y.d.Mercator}},{key:"createChartSeries",value:function(e){this.props.statistic;var a=this.chart.series.push(new Y.b),t=(a=Object.assign(a,e)).mapPolygons.template;a.heatRules.push({property:"fill",target:t,min:W.c("#85DB50"),max:W.c("#F33A21"),minValue:0,maxValue:4}),t.tooltipText="{name}: {value}",t.nonScalingStroke=!0,t.strokeWidth=.5,t.states.create("hover").properties.fill=W.c("#83FE00"),t.cursorOverStyle=W.b.pointer;var n=this.props,r=n.onMapClick,i=n.onNoData;return t.events.on("hit",(function(e){var a=e.target.dataItem.dataContext,t=(a.id,a.value,a.area),n=a.name;t?r(t):i(n)})),a}},{key:"initChartInterface",value:function(){var e=this,a=this.state.showState;this.chart.zoomControl=new Y.c,this.chart.zoomControl.cursorOverStyle=W.b.pointer;var t=this.chart.chartContainer.createChild(W.a);t.label.text="".concat(a?"Hide":"Show"," States/Provinces"),t.togglable=!0,t.padding(5,5,5,5),t.align="right",t.marginRight=15,t.cursorOverStyle=W.b.pointer,t.events.on("hit",(function(){e.onShowState(t.isActive);var a=e.state.showState;e.stateSeries.forEach((function(e){return e.disabled=!a})),t.label.text="".concat(a?"Hide":"Show"," States/Provinces")}))}},{key:"createChart",value:function(){var e=this.state.heatmapData;this.initChart();this.createChartSeries({geodata:z.a,exclude:["AQ"],data:e});var a=this.createChartSeries({geodata:U.a,data:e,disabled:!this.state.showState});this.stateSeries=[a],this.initChartInterface()}},{key:"resetChart",value:function(){var e=this.state.heatmapData,a=(this.createChartSeries({geodata:z.a,exclude:["AQ"],data:e}),this.createChartSeries({geodata:U.a,data:e,disabled:!this.state.showState}));this.stateSeries=[a]}},{key:"componentWillUnmount",value:function(){this.chart&&this.chart.dispose()}},{key:"render",value:function(){return r.a.createElement("div",{id:"chartdiv"})}}]),t}(n.Component),ae=(t(749),O.a.Option),te=function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(e){var n;return Object(o.a)(this,t),(n=a.call(this,e)).componentDidMount=function(){n.formRef=r.a.createRef(),n.modelAPI=new F,n.modelAPI.latest_score_date((function(e){return n.setState({latestDate:e[0].date,weeks:e[0].weeks,latestWeek:e[0].weeks},(function(){n.addAreaByStr("US"),n.formRef.current.setFieldsValue({weeks:n.state.latestWeek}),n.map.fetchData(n.state.dynamicMapOn)}))})),n.modelAPI.areas((function(e){return n.setState({areasList:e})}))},n.bindRef=function(e){n.map=e},n.onAlertClose=function(){n.setState({noDataError:!1})},n.onNoData=function(e){n.setState({noDataError:!0,errorDescription:"There is currently no data for ".concat(e)})},n.generateMarks=function(){for(var e=n.state.latestDate,a=new Date("".concat(e,"T00:00")),t=new Date(2020,2,11),r={},i=0;t<=a;)r[i]="".concat(t.getMonth()+1,"/").concat(t.getDate()),t.setDate(t.getDate(Date)+7),i++;return r},n.state={areas:n.props.areas||[],areasList:[],latestDate:"",mainGraphData:{},weeks:n.props.weeks||0,latestWeek:0,dynamicMapOn:!1,noDataError:!1,errorDescription:""},n.addAreaByStr=n.addAreaByStr.bind(Object(C.a)(n)),n.removeAreaByStr=n.removeAreaByStr.bind(Object(C.a)(n)),n.onValuesChange=n.onValuesChange.bind(Object(C.a)(n)),n.onMapClick=n.onMapClick.bind(Object(C.a)(n)),n.onWeeksChange=n.onWeeksChange.bind(Object(C.a)(n)),n.switchDynamicMap=n.switchDynamicMap.bind(Object(C.a)(n)),n.onAlertClose=n.onAlertClose.bind(Object(C.a)(n)),n.onNoData=n.onNoData.bind(Object(C.a)(n)),n.generateMarks=n.generateMarks.bind(Object(C.a)(n)),n}return Object(c.a)(t,[{key:"onMapClick",value:function(e){this.areaIsSelected(e)||this.addAreaByStr(G(e))}},{key:"areaIsSelected",value:function(e){if(this.state.areas&&e){var a=G(e);return this.state.areas.includes(a)}return!1}},{key:"addAreaByStr",value:function(e){var a=this,t=L(e);this.setState((function(a){return{areas:[].concat(Object(E.a)(a.areas),[e])}}),(function(){a.modelAPI.scores({state:t.state,country:t.country,weeks:a.state.weeks},(function(t){a.setState((function(a){return{mainGraphData:Object(k.a)({},a.mainGraphData,Object(D.a)({},e,t))}}))})),a.formRef.current.setFieldsValue({areas:a.state.areas})}))}},{key:"removeAreaByStr",value:function(e){this.setState((function(a){return{areas:a.areas.filter((function(a){return a!==e})),mainGraphData:Object.keys(a.mainGraphData).filter((function(a){return a!==e})).reduce((function(e,t){return Object(k.a)({},e,Object(D.a)({},t,a.mainGraphData[t]))}),{})}}))}},{key:"onValuesChange",value:function(e,a){var t=this.state.areas,n=a.areas,r=n.filter((function(e){return!t.includes(e)})),i=t.filter((function(e){return!n.includes(e)}));r.forEach(this.addAreaByStr),i.forEach(this.removeAreaByStr)}},{key:"onWeeksChange",value:function(e){var a=this;this.setState({weeks:e},(function(){a.reloadAll()}))}},{key:"reloadAll",value:function(){var e=this,a=this.state.areas;this.setState({areas:[],mainGraphData:{}},(function(){a.forEach(e.addAreaByStr),e.state.dynamicMapOn&&e.map.fetchData(e.state.dynamicMapOn)}))}},{key:"switchDynamicMap",value:function(e){this.setState({dynamicMapOn:e}),this.map.fetchData(e)}},{key:"render",value:function(){var e=this,a=this.state,t=a.areas,n=a.areasList,i=a.weeks,s=a.mainGraphData,o=a.dynamicMapOn,c=a.latestWeek,l=a.noDataError,u=a.errorDescription,p=n.filter((function(a){return!e.areaIsSelected(a)})).map(G).sort().map((function(e){return r.a.createElement(ae,{key:e}," ",e," ")})),f=this.generateMarks();return r.a.createElement("div",{className:"score-page"},r.a.createElement(d.a,{type:"flex",justify:"space-around"},r.a.createElement(h.a,{span:10},l?r.a.createElement(b.a,{message:"".concat(u),description:"Please wait for our updates.",type:"error",closable:!0,onClose:this.onAlertClose}):null,r.a.createElement("div",{className:"form-wrapper"},r.a.createElement(g.a,{ref:this.formRef,onValuesChange:this.onValuesChange},r.a.createElement(g.a.Item,{label:"Areas",name:"areas",rules:[{required:!0,message:"Please select areas!"}]},r.a.createElement(O.a,{mode:"multiple",style:{width:"100%"},placeholder:"Select Areas"},p)),r.a.createElement(g.a.Item,{label:"Week to check",name:"weeks",rules:[{required:!0,message:"Please select the week you want to see"}]},r.a.createElement(y.a,{marks:f,min:0,initialValue:c,max:c,onAfterChange:this.onWeeksChange}))),r.a.createElement("p",null,"Dynamic Map:\xa0\xa0",r.a.createElement(m.a,{onChange:this.switchDynamicMap})))),r.a.createElement(h.a,{span:14},r.a.createElement("div",{className:"map-wrapper"},r.a.createElement(ee,{className:"score-map",triggerRef:this.bindRef,dynamicMapOn:o,weeks:i,latestWeek:c-1,onMapClick:this.onMapClick,onNoData:this.onNoData})))),t.length?r.a.createElement(d.a,null,r.a.createElement(h.a,{span:24},r.a.createElement("div",{className:"graph-wrapper"},r.a.createElement(N,{data:s,statistic:"cumulative",yScale:"linear",dataType:"confirmed"})))):null)}}]),t}(n.PureComponent),ne=t(453),re=t(53),ie=(t(750),t(221)),se=(t(752),function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(e){var n;return Object(o.a)(this,t),(n=a.call(this,e)).handleItemClick=function(e){var a=n.props,t=a.redirectForecast,r=a.redirectAbout,i=a.redirectScore,s=e.key;n.setState({activeItem:e.key}),"forecast"===s?t():"information"===s?r():i()},n.state={activateItem:"forecast"},n}return Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(d.a,{className:"navbar-container"},r.a.createElement(h.a,null,r.a.createElement("img",{className:"logo",src:"https://identity.usc.edu/files/2011/12/combo_gold_white_cardinal.png",alt:"USC"})),r.a.createElement(h.a,null,r.a.createElement(ie.a,{theme:"light",mode:"horizontal",onClick:this.handleItemClick,defaultSelectedKeys:["forecast"]},r.a.createElement(ie.a.Item,{key:"forecast"},"COVID-19 Forecast"),r.a.createElement(ie.a.Item,{key:"quarantine-score"},"Social Distancing Score"),r.a.createElement(ie.a.Item,{key:"information"},"About Us"))))}}]),t}(n.Component)),oe=(t(759),function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(e){var n;return Object(o.a)(this,t),(n=a.call(this,e)).redirectForecast=function(){n.setState({redirectForecast:!0,redirectAbout:!1,redirectScore:!1})},n.redirectAbout=function(){n.setState({redirectForecast:!1,redirectAbout:!0,redirectScore:!1})},n.redirectScore=function(){n.setState({redirectForecast:!1,redirectAbout:!1,redirectScore:!0})},n.state={redirectForecast:!1,redirectAbout:!1,redirectScore:!1},n}return Object(c.a)(t,[{key:"render",value:function(){var e=this.state,a=e.redirectForecast,t=e.redirectAbout,n=e.redirectScore;return r.a.createElement(ne.a,null,a?r.a.createElement(re.a,{to:"/ReCOVER-COVID-19"}):null,n?r.a.createElement(re.a,{to:"/ReCOVER-COVID-19/score"}):null,t?r.a.createElement(re.a,{to:"/ReCOVER-COVID-19/about"}):null,r.a.createElement(se,{redirectForecast:this.redirectForecast,redirectScore:this.redirectScore,redirectAbout:this.redirectAbout}),r.a.createElement(re.d,null,r.a.createElement(re.b,{exact:!0,path:"/ReCOVER-COVID-19",render:function(e){return r.a.createElement($,e)}}),r.a.createElement(re.b,{exact:!0,path:"/ReCOVER-COVID-19/score",render:function(e){return r.a.createElement(te,e)}}),r.a.createElement(re.b,{exact:!0,path:"/ReCOVER-COVID-19/about",render:function(e){return r.a.createElement(Z,e)}})))}}]),t}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(oe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[493,1,3]]]);
//# sourceMappingURL=main.0bf07717.chunk.js.map